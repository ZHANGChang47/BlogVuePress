(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{566:function(s,a,t){"use strict";t.r(a);var n=t(17),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"elasticsearch"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch"}},[s._v("#")]),s._v(" ElasticSearch")]),s._v(" "),t("h2",{attrs:{id:"_1、搜索引擎介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、搜索引擎介绍"}},[s._v("#")]),s._v(" 1、搜索引擎介绍")]),s._v(" "),t("blockquote",[t("p",[s._v("在互联网项目中，涉及到检索的业务需求很多，我们可以通过对数据库的模糊查询实现检索功能，但是针对\n⼤数据量的操作，基于数据库的检索就显得力不从⼼了（查询效率很低）。所需我们要寻求⼀种⾼效的数据\n检索解决⽅案")])]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101110429637","data-src":"https://s2.loli.net/2022/01/01/nXYOL9KCogFbZQt.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("所谓搜索引擎，就是根据用户需求与⼀定算法，运用特定策略从互联网检索出指定的信息反馈给用户的⼀门检索技\n术。搜索引擎依托于多种技术，如网络爬虫技术、检索排序技术、网页处理技术、大数据处理技术、自然语言处理\n技术等，为信息检索用户提供快速、高相关性的信息服务。搜索引擎技术的核心模块⼀般包括爬虫、索引、检索和\n排序等，同时可添加其他⼀系列辅助模块，以为用户创造更好的网络使用环境")]),s._v(" "),t("p",[s._v("搜索方式：")]),s._v(" "),t("p",[s._v("搜索方式是搜索引擎的⼀个关键环节，大致可分为四种： 全文搜索引擎、 元搜索引擎、 垂直搜索引擎和目录搜\n索引擎，它们各有特点并适用于不同的搜索环境")]),s._v(" "),t("h2",{attrs:{id:"_2、lucene简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、lucene简介"}},[s._v("#")]),s._v(" 2、Lucene简介")]),s._v(" "),t("h3",{attrs:{id:"_2-1、doug-cutting"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、doug-cutting"}},[s._v("#")]),s._v(" 2.1、Doug Cutting")]),s._v(" "),t("p",[s._v("1997年底， Cutting开始以每周两天的时间投⼊，在家里试着用Java把这个想法变成现实，不久之后， Lucene诞⽣\n了。作为第⼀个提供全文文本搜索的开源函数库， Lucene的伟大自不必多言。")]),s._v(" "),t("h3",{attrs:{id:"_2-2、lucene介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、lucene介绍"}},[s._v("#")]),s._v(" 2.2、Lucene介绍")]),s._v(" "),t("blockquote",[t("p",[s._v("Lucene是Apache Jakarta家族中的⼀个开源项目，是⼀个开放源代码的全⽂检索引擎⼯具包，但它不是⼀个\n完整的 全文检索引擎，而是⼀个全⽂检索引擎的架构，提供了完整的查询引擎、索引引擎和部分⽂本分析引\n擎。\nLucene提供了⼀个简单却强⼤的应⽤程式接⼝，能够做全⽂索引和搜寻。在Java开发环境⾥Lucene是⼀个成\n熟的免费开源⼯具，是⽬前最为流⾏的基于 Java 开源全⽂检索⼯具包。")])]),s._v(" "),t("ul",[t("li",[s._v("数据总体分为两种：\n"),t("ul",[t("li",[s._v("结构化数据：指具有固定格式或有限长度的数据，如数据库、元数据等")]),s._v(" "),t("li",[s._v("非结构化数据：指不定长或无固定格式的数据，如邮件、 word⽂档等磁盘上的⽂件")])])]),s._v(" "),t("li",[s._v("对于结构化数据的全⽂搜索很简单，因为数据都是有固定格式的，例如搜索数据库中数据使⽤SQL语句即可")]),s._v(" "),t("li",[s._v("对于非结构化数据，有以下两种⽅法：\n"),t("ul",[t("li",[s._v("顺序扫描法(Serial Scanning)")]),s._v(" "),t("li",[s._v("全文检索(Full-text Search)")])])])]),s._v(" "),t("p",[s._v("**顺序扫描法：**如果要找包含某⼀特定内容的⽂件，对于每⼀个⽂档，从头到尾扫描内容，如果此⽂档包含此字符\n串， 则此⽂档为我们要找的⽂件，接着看下⼀个⽂件，直到扫描完所有的⽂件，因此速度很慢。")]),s._v(" "),t("p",[s._v("**全文检索：**将⾮结构化数据中的⼀部分信息提取出来，重新组织，使其变得具有⼀定结构，然后对此有⼀定结构\n的数 据进⾏搜索，从⽽达到搜索相对较快的⽬的。这部分从⾮结构化数据中提取出的然后重新组织的信息，我们\n称之索引。")]),s._v(" "),t("h3",{attrs:{id:"_2-3、lucene全文检索流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、lucene全文检索流程"}},[s._v("#")]),s._v(" 2.3、Lucene全文检索流程")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101112231114","data-src":"https://s2.loli.net/2022/01/01/O52nPX4sqxrBYSl.png",loading:"lazy"}})]),s._v(" "),t("ul",[t("li",[s._v("创建索引过程，对要搜索的原始内容进⾏索引构建⼀个索引库。索引过程包括：确定原始内容即要搜索的内\n容→采集⽂档→创建⽂档→分析⽂档→索引⽂档。")]),s._v(" "),t("li",[s._v("搜索索引过程，从索引库中搜索内容。搜索过程包括：⽤户通过搜索界⾯→创建查询→执⾏搜索，从索引库\n搜索→ 渲染搜索结果。")])]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101112305765","data-src":"https://s2.loli.net/2022/01/01/DKdupneUJYHN1Wf.png",loading:"lazy"}})]),s._v(" "),t("h4",{attrs:{id:"_2-3-1、创建索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1、创建索引"}},[s._v("#")]),s._v(" 2.3.1、创建索引")]),s._v(" "),t("p",[s._v("对文档索引的过程，将⽤户要搜索的⽂档内容进⾏索引，索引存储在索引库（index）中。 这⾥我们要搜索的⽂档\n是 磁盘上的⽂本⽂件，根据案例描述：凡是⽂件名或⽂件内容包括关键字的⽂件都要找出来，这⾥要对⽂件名和\n⽂件内容创建索引。")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("获得原始文档")])]),s._v(" "),t("p",[s._v("原始⽂档是指要索引和搜索的内容。原始内容包括互联⽹上的⽹⻚、数据库中的数据、磁盘上的⽂件等。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("创建⽂档对象")])]),s._v(" "),t("p",[s._v("获取原始内容的⽬的是为了索引，在索引前需要将原始内容创建成⽂档（Document），⽂档中包括⼀个⼀个\n的域 （Field），域中存储内容。 这⾥我们可以将磁盘上的⼀个⽂件当成⼀个document， Document中包括⼀\n些 Field（file_name⽂件名称、 file_path⽂件路径、 file_size⽂件⼤⼩、 file_content⽂件内容），如下图：")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101112426123","data-src":"https://s2.loli.net/2022/01/01/de4hDLCUOaTNzsZ.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("注意：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("每个Document可以有多个Field，不同的Document可以有不同的Field")])]),s._v(" "),t("li",[t("p",[s._v("每个⽂档都有⼀个唯⼀的编号，就是⽂档id")])])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("分析⽂档")])]),s._v(" "),t("p",[s._v("将原始内容创建为包含域（Field）的⽂档（document），需要再对域中的内容进⾏分析，分析的过程是经过\n对原始⽂档提取单词、将字⺟转为⼩写、去除标点符号、去除停⽤词等过程⽣成最终的语汇单元，可以将语\n汇单元理解为⼀ 个⼀个的单词。 ⽐如下边的⽂档经过分析如下：")]),s._v(" "),t("p",[s._v("原文档内容：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Lucene is a Java full-text search engine. Lucene is not a complete application, but rather\na code library and API that can easily be used to add search capabilities to applications.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("分析后得到的语汇单元：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("lucene、 java、 full、 search、 engine...\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("每个单词叫做⼀个Term，不同的域中拆分出来的相同的单词是不同的term。 term中包含两部分⼀部分是⽂档\n的域名，另⼀部分是单词的内容。 例如：⽂件名中包含apache和文件内容中包含的apache是不同的term。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("创建索引—倒排索引")])]),s._v(" "),t("p",[s._v("对所有⽂档分析得出的语汇单元进⾏索引，索引的⽬的是为了搜索，最终要实现只搜索被索引的语汇单元从\n⽽找到 Document（⽂档）")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101112824876","data-src":"https://s2.loli.net/2022/01/01/faC3onqie9j7GJh.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("注意：创建索引是对语汇单元索引，通过词语找⽂档，这种索引的结构叫倒排索引结构。 传统⽅法是根据⽂\n件找到 该⽂件的内容，在⽂件内容中匹配搜索关键字，这种⽅法是顺序扫描⽅法，数据量⼤、搜索慢。 倒排\n索引结构是根 据内容（词语）找⽂档，如下图：")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101112908854","data-src":"https://s2.loli.net/2022/01/01/ymHgT9SncuG6xr1.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("倒排索引结构也叫反向索引结构，包括索引和⽂档两部分，索引即词汇表，它的规模较⼩，⽽⽂档集合较⼤。")])])]),s._v(" "),t("h4",{attrs:{id:"_2-3-2、查询索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-2、查询索引"}},[s._v("#")]),s._v(" 2.3.2、查询索引")]),s._v(" "),t("p",[s._v("查询索引也是搜索的过程。搜索就是⽤户输⼊关键字，从索引（index）中进⾏搜索的过程。根据关键字搜索索\n引， 根据索引找到对应的⽂档，从⽽找到要搜索的内容（这⾥指磁盘上的⽂件）。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("⽤户查询接⼝")]),s._v(" "),t("p",[s._v("全⽂检索系统提供⽤户搜索的界⾯供⽤户提交搜索的关键字，搜索完成展示搜索结果。 Lucene不提供制作⽤\n户搜索界⾯的功能，需要根据⾃⼰的需求开发搜索界⾯。")])]),s._v(" "),t("li",[t("p",[s._v("创建查询")]),s._v(" "),t("p",[s._v("⽤户输⼊查询关键字执⾏搜索之前需要先构建⼀个查询对象，查询对象中可以指定查询要搜索的Field⽂档\n域、查询关键字等，查询对象会⽣成具体的查询语法，例如： 语法 “fileName:lucene”表示要搜索Field域的内\n容为“lucene”的⽂档")])]),s._v(" "),t("li",[t("p",[s._v("执⾏查询")]),s._v(" "),t("p",[s._v("搜索索引过程： 根据查询语法在倒排索引词典表中分别找出对应搜索词的索引，从⽽找到索引所链接的⽂档\n链表。 ⽐如搜索语法为“fileName:lucene”表示搜索出fileName域中包含Lucene的⽂档。 搜索过程就是在索引\n上查找域为 fileName，并且关键字为Lucene的term，并根据term找到⽂档id列表。")])]),s._v(" "),t("li",[t("p",[s._v("渲染查询结果")]),s._v(" "),t("p",[s._v("以⼀个友好的界⾯将查询结果展示给⽤户，⽤户根据搜索结果找⾃⼰想要的信息，为了帮助⽤户很快找到⾃\n⼰的结 果，提供了很多展示的效果，⽐如搜索结果中将关键字⾼亮显示，百度提供的快照等。")])])]),s._v(" "),t("h3",{attrs:{id:"_2-4、分词器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4、分词器"}},[s._v("#")]),s._v(" 2.4、分词器")]),s._v(" "),t("h4",{attrs:{id:"_2-4-1、分词器的作用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-1、分词器的作用"}},[s._v("#")]),s._v(" 2.4.1、分词器的作用")]),s._v(" "),t("p",[s._v("a. 在创建索引的时候需要⽤到分词器，在使⽤字符串搜索的时候也会⽤到分词器，并且这两个地⽅要使⽤同⼀个\n分词器，否则可能会搜索不出来结果。")]),s._v(" "),t("p",[s._v("b. 分词器(Analyzer)的作⽤是把⼀段⽂本中的词按规则取出所包含的所有词，对应的是Analyzer类，这是⼀个抽 象\n类(public abstract class org.apache.lucene.analysis.Analyzer)，切分词的具体规则是由⼦类实现的，所以对于不 同的\n语⾔规则，要有不同的分词器。")]),s._v(" "),t("h4",{attrs:{id:"_2-4-2、英文分词器的原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-2、英文分词器的原理"}},[s._v("#")]),s._v(" 2.4.2、英文分词器的原理")]),s._v(" "),t("p",[s._v("a.英⽂的处理流程为：输⼊⽂本，词汇切分，词汇过滤(去除停⽤词)，词⼲提取(形态还原)、⼤写转⼩写，结果输\n出。")]),s._v(" "),t("p",[s._v("b. 何为形态还原，意思是：去除单词词尾的形态变化，将其还原为词的原形，这样做可以搜索出更多有意义的结\n果，⽐如在搜索student的时候，同事也可以搜索出students的结果。")]),s._v(" "),t("p",[s._v("c. 任何⼀个分词法对英⽂的⽀持都是还可以的。")]),s._v(" "),t("h4",{attrs:{id:"_2-4-3、中文分词器的原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-3、中文分词器的原理"}},[s._v("#")]),s._v(" 2.4.3、中文分词器的原理")]),s._v(" "),t("p",[s._v('中⽂分词⽐较复杂，并没有英⽂分词那么简单，这主要是因为中⽂的词与词之间并不是像英⽂那样⽤空格来隔\n开，因为不是⼀个字就是⼀个词，⽽且⼀个词在另外⼀个地⽅就可能不是⼀个词，如： "我们是中国⼈"， "是中"就不是⼀ 个词，对于中⽂分词，通常有三种⽅式：单字分词、⼆分法分词、词典分词。')]),s._v(" "),t("ul",[t("li",[s._v('单字分词：就是按照中⽂⼀个字⼀个字的进⾏分词，⽐如:"我们是中国⼈"，分词的效果就是"我"， "们"， "是"， "中"， "国"， "⼈"， StandardAnalyzer分词法就是单字分词。')]),s._v(" "),t("li",[s._v('⼆分法分词：按照两个字进⾏切分，⽐如： "我们是中国⼈"，分词的效果就是： "我们"， "们是"， "是中"， "中国"， "国⼈"， CJKAnalyzer分词法就是⼆分法分词')]),s._v(" "),t("li",[s._v('词库分词：按照某种算法构造词，然后去匹配已建好的词库集合，如果匹配到就切分出来成为词语，通常词库分词被认为是最好的中⽂分词算法，如： "我们是中国⼈"，分词的效果就是:"我们"， "中国⼈"，极易分词MMAnalyzer、庖丁分词、 IkAnalyzer等分词法就是属于词库分词。')])]),s._v(" "),t("h4",{attrs:{id:"_2-4-4、停用词的规"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-4、停用词的规"}},[s._v("#")]),s._v(" 2.4.4、停用词的规")]),s._v(" "),t("p",[s._v('有些词在⽂本中出现的频率⾮常⾼，但是对⽂本所携带的信息基本不产⽣影响，例如英⽂的"a、 an、 the、 of"或中⽂ 的"的、了、着、是"，以及各种标点符号等，这样的词称为停⽤词，⽂本经过分词处理后，停⽤词通常会被过滤掉， 不会被进⾏索引，在检索的时候，⽤户的查询中如果含有停⽤词，检索系统也会将其过滤掉，这是因为⽤户输⼊查询字符串也要进⾏分词处理，排除停⽤词可以提升建⽴索引的速度，减⼩索引库⽂件的⼤⼩。')]),s._v(" "),t("h4",{attrs:{id:"_2-4-5、常用分词器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-5、常用分词器"}},[s._v("#")]),s._v(" 2.4.5、常用分词器")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("WhitespaceAnalyzer")]),s._v(" "),t("p",[s._v("仅仅是去掉了空格，没有其他任何操作，不⽀持中⽂。")])]),s._v(" "),t("li",[t("p",[s._v("SimpleAnalyzer")]),s._v(" "),t("p",[s._v("将除了字⺟以外的符号全部去除，并且将所有字符变为⼩写，需要注意的是这个分词器同样把数据也去除\n了，同样不⽀持中⽂。")])]),s._v(" "),t("li",[t("p",[s._v("StopAnalyzer")]),s._v(" "),t("p",[s._v("这个和SimpleAnalyzer类似，不过⽐他增加了⼀个的是，在其基础上还去除了所谓的stop words，⽐如the, a,\nthis这些。这个也是不⽀持中⽂的。")])]),s._v(" "),t("li",[t("p",[s._v("StandardAnalyzer")]),s._v(" "),t("p",[s._v("英⽂⽅⾯的处理和StopAnalyzer⼀样的，对中⽂⽀持，使⽤的是单字切割。")])]),s._v(" "),t("li",[t("p",[s._v("CJKAnalyzer")]),s._v(" "),t("p",[s._v("这个⽀持中⽇韩，前三个字⺟也就是这三个国家的缩写。这个对于中⽂基本上不怎么⽤吧，对中⽂的⽀持很\n烂，它是 ⽤每两个字作为分割，分割⽅式个⼈感觉⽐较奇葩，我会在下⾯⽐较举例。")])]),s._v(" "),t("li",[t("p",[s._v("SmartChineseAnalyzer")]),s._v(" "),t("p",[s._v("中⽂的分词,⽐较标准的中⽂分词，对⼀些搜索处理的并不是很好。")])]),s._v(" "),t("li",[t("p",[s._v("IKAnalyzer")]),s._v(" "),t("p",[s._v("中国人自己开发，对于中文分词比较精准")])])]),s._v(" "),t("h4",{attrs:{id:"_2-4-6、ik-分词器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-6、ik-分词器"}},[s._v("#")]),s._v(" 2.4.6、IK 分词器")]),s._v(" "),t("p",[s._v("Elasticsearch中⽂分词我们采⽤Ik分词， ik有两种分词模式： ik_max_word和ik_smart模式;")]),s._v(" "),t("p",[s._v("ik_max_word 和 ik_smart 什么区别?")]),s._v(" "),t("ul",[t("li",[s._v("ik_max_word: 会将⽂本做最细粒度的拆分，⽐如会将“中华⼈⺠共和国国歌”拆分为“中华⼈⺠共和国,中华⼈\n⺠, 中华,华⼈,⼈⺠共和国,⼈⺠,⼈,⺠,共和国,共和,和国,国歌”，会穷尽各种可能的组合；")]),s._v(" "),t("li",[s._v("ik_smart: 会做最粗粒度的拆分，⽐如会将“中华⼈⺠共和国国歌”拆分为“中华⼈⺠,共和国,国歌”。 索引时，为\n了提供索引的覆盖范围，通常会采⽤ik_max_word分析器，会以最细粒度分词索引，搜索时为了提⾼搜索准确\n度，会采⽤ik_smart分析器，会以粗粒度分词")])]),s._v(" "),t("p",[s._v("我们可以使⽤⽹上的⼀些⼯具查看分词的效果，比如https://www.sojson.com/analyzer")]),s._v(" "),t("h3",{attrs:{id:"_2-5、lucene全文检索与数据库查询的比较"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-5、lucene全文检索与数据库查询的比较"}},[s._v("#")]),s._v(" 2.5、lucene全文检索与数据库查询的比较")]),s._v(" "),t("h4",{attrs:{id:"_2-5-1、性能上"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-1、性能上"}},[s._v("#")]),s._v(" 2.5.1、性能上")]),s._v(" "),t("ul",[t("li",[s._v("数据库：⽐如我要查找某个商品，根据商品名，⽐如select * from product where doctname like %keywords%,这样查询的话对于数据量少是可以的，可是⼀旦你的数据量巨⼤⼏万⼏⼗万的时候，你的性能将会极⼤的减弱。")]),s._v(" "),t("li",[s._v("lucene: 全⽂检索，建⽴⼀个索引库，⼀次建⽴多次使⽤。在索引库⾥⾯会把所有的商品名根据分词器建⽴索引，就好⽐新华字典，索引对应document，⽐如输⼊衬衫，那么就会根据索引迅速的翻到衬衫对应的商品名，时间迅速， 性能很好。")])]),s._v(" "),t("h4",{attrs:{id:"_2-5-2、相关度排序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-2、相关度排序"}},[s._v("#")]),s._v(" 2.5.2、相关度排序")]),s._v(" "),t("ul",[t("li",[s._v("数据库：数据库要实现该功能也是可以的，可是需要改变表的结构，添加⼀个字段，然后该字段⽤于排名，最后查询 的时候order by ⼀下")]),s._v(" "),t("li",[s._v("lucene: 查询出来的document都有⼀个算法（得分），根据算法可以计算得分，得分越⾼的排名越靠前，⽐如百度搜索⼀个东⻄，⼀般排名靠前的得分越⾼，得分通过算法，可以⼈⼯控制，⽐如百度推⼴，企业给的钱多得分⾃然⾼，因此排名靠前")])]),s._v(" "),t("h4",{attrs:{id:"_2-5-3、准确性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-3、准确性"}},[s._v("#")]),s._v(" 2.5.3、准确性")]),s._v(" "),t("ul",[t("li",[s._v("数据库： select * from product where doctname like %ant%,搜索出来的可以是plant,aplant,planting等等，准确性不⾼")]),s._v(" "),t("li",[s._v("lucene：通过索引查询的，就好像你查字典⼀样，准确性⽐数据库的模糊查询⾼许多")])]),s._v(" "),t("h2",{attrs:{id:"_3、elasticsearch简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、elasticsearch简介"}},[s._v("#")]),s._v(" 3、ElasticSearch简介")]),s._v(" "),t("h3",{attrs:{id:"_3-1、elasticsearch-vs-lucene的关系"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1、elasticsearch-vs-lucene的关系"}},[s._v("#")]),s._v(" 3.1、ElasticSearch vs Lucene的关系")]),s._v(" "),t("p",[s._v("ElasticSearch vs Lucene的关系，简单⼀句话就是，成品与半成品的关系。")]),s._v(" "),t("p",[s._v("（1） Lucene专注于搜索底层的建设，⽽ElasticSearch专注于企业应⽤。")]),s._v(" "),t("p",[s._v("（2） Luncene是单节点的API， ElasticSearch是分布式的—为集群⽽⽣。")]),s._v(" "),t("p",[s._v("（3） Luncene需要⼆次开发，才能使⽤。不能像百度或⾕歌⼀样，它只是提供⼀个接⼝需要被实现才能使⽤,\nElasticSearch直接拿来⽤。")]),s._v(" "),t("h3",{attrs:{id:"_3-2、elasticsearch与solr对比"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2、elasticsearch与solr对比"}},[s._v("#")]),s._v(" 3.2、ElasticSearch与Solr对比")]),s._v(" "),t("p",[s._v("Solr与elasticsearch是当前两⼤最流⾏的搜索应⽤服务器，他们的底层都是基于lucene。")]),s._v(" "),t("ul",[t("li",[s._v("Elasticsearch是分布式的，不需要其他组件， Solr 利⽤ Zookeeper 进行分布式管理，而Elasticsearch ⾃身带 有\n分布式协调管理功能")]),s._v(" "),t("li",[s._v("Elasticsearch设计用于云计算中，处理多租户不需要特殊配置，而Solr则需要更多的⾼级设置。")]),s._v(" "),t("li",[s._v("当单纯的对已有数据进⾏搜索时， Solr更快，实时建立索引时, Solr会产⽣io阻塞，查询性能较差, Elasticsearch\n具有明显的优势，随着数据量的增加， Solr的搜索效率会变得更低，⽽Elasticsearch却没有明显的变化")])]),s._v(" "),t("p",[s._v("Elasticsearch与Solr的性能测试比较:")]),s._v(" "),t("p",[s._v("当单纯的对已有数据进行搜索时， Solr更快")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101113853579","data-src":"https://s2.loli.net/2022/01/01/MEbvZ6ISkJ5tjBp.png",loading:"lazy"}})]),s._v(" "),t("h3",{attrs:{id:"_3-3、elasticsearch特性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3、elasticsearch特性"}},[s._v("#")]),s._v(" 3.3、Elasticsearch特性")]),s._v(" "),t("h4",{attrs:{id:"_3-3-1、安装管理方便"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-1、安装管理方便"}},[s._v("#")]),s._v(" 3.3.1、安装管理⽅便")]),s._v(" "),t("p",[s._v("Elasticsearch没有其他依赖，下载后安装⾮常⽅便；只⽤修改⼏个参数就可以搭建起来⼀个集群。")]),s._v(" "),t("h4",{attrs:{id:"_3-3-2、大规模分布式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-2、大规模分布式"}},[s._v("#")]),s._v(" 3.3.2、大规模分布式")]),s._v(" "),t("p",[s._v("Elasticsearch允许你开始⼩规模使⽤，但是随着你使⽤数据的增⻓，它可以建⽴在横向扩展的开箱即⽤。当你需要\n更多的容量，只需添加更多的节点，并让集群重组，只需要增加额外的硬件，让集群⾃动利⽤额外的硬件。")]),s._v(" "),t("p",[t("code",[s._v("可以在数以百计的服务器上处理PB级别的数据")]),s._v("。")]),s._v(" "),t("p",[s._v("节点对外表现对等（每个节点都可以⽤来做⼊⼝）；加⼊节点⾃动均衡，可以扩展到上百台服务器，处理PB级别\n的结构化或⾮结构化数据。")]),s._v(" "),t("p",[s._v("Elasticsearch致⼒于隐藏分布式系统的复杂性。以下这些操作都是在底层⾃动完成的：")]),s._v(" "),t("ul",[t("li",[s._v("将你的⽂档分区到不同的容器或者分⽚(shards)中，它们可以存在于⼀个或多个节点中；")]),s._v(" "),t("li",[s._v("将分⽚均匀的分配到各个节点，对索引和搜索做负载均衡；")]),s._v(" "),t("li",[s._v("冗余每⼀个分⽚，防⽌硬件故障造成的数据丢失；")]),s._v(" "),t("li",[s._v("将集群中任意⼀个节点上的请求路由到相应数据所在的节点；")]),s._v(" "),t("li",[s._v("⽆论是增加节点，还是移除节点，分⽚都可以做到⽆缝的扩展和迁移")])]),s._v(" "),t("h4",{attrs:{id:"_3-3-3、多租户支持"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-3、多租户支持"}},[s._v("#")]),s._v(" 3.3.3、多租户支持")]),s._v(" "),t("p",[s._v("ES处理多租户不需要特殊配置，可根据不同的⽤途分索引；可以同时操作多个索引。")]),s._v(" "),t("p",[s._v("ES 的多租户简单的说就是通过多索引机制同时提供给多种业务使⽤，每种业务使⽤⼀个索引。我们可以把索引理\n解 为关系型数据库⾥的库，那多索引可以理解为⼀个数据库系统建⽴多个库给不同的业务使⽤。")]),s._v(" "),t("p",[s._v("在实际使⽤时，我们可以通过每个租户⼀个索引的⽅式将他们的数据进⾏隔离，并且每个索引是可以单独配置参数\n的 （可对特定租户进⾏调优），这在典型的多租户场景下⾮常有⽤：例如我们的⼀个多租户应⽤需要提供搜索⽀\n持，这 时可以通过 ES 根据租户建⽴索引，这样每个租户就可以在⾃⼰的索引下搜索相关内容了")]),s._v(" "),t("h4",{attrs:{id:"_3-3-4、高可用性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-4、高可用性"}},[s._v("#")]),s._v(" 3.3.4、高可用性")]),s._v(" "),t("p",[s._v("Elasticsearch集群是有弹性的 - 他们会⾃动检测到新的或失败的节点，以及重组和重新平衡数据，以确保数据安\n全。")]),s._v(" "),t("h4",{attrs:{id:"_3-3-5、操作持久化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-5、操作持久化"}},[s._v("#")]),s._v(" 3.3.5、操作持久化")]),s._v(" "),t("p",[s._v("Elasticsearch把数据安全第⼀。⽂档改变被记录在群集上的多个节点上的事务⽇志(transaction logs)中记录，以减少\n任何数据丢失的机会。")]),s._v(" "),t("h4",{attrs:{id:"_3-3-6、友好的restful-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-6、友好的restful-api"}},[s._v("#")]),s._v(" 3.3.6、友好的RESTful API")]),s._v(" "),t("p",[s._v("Elasticsearch是API驱动。⼏乎任何动作都可以⽤⼀个简单的RESTful API使⽤JSON基于HTTP请求。 ElasticSearch 提\n供多种语⾔的客户端 API。")]),s._v(" "),t("h3",{attrs:{id:"_3-4、典型使用案例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4、典型使用案例"}},[s._v("#")]),s._v(" 3.4、典型使用案例")]),s._v(" "),t("ul",[t("li",[s._v("维基百科使⽤Elasticsearch来进⾏全⽂搜做并⾼亮显示关键词，以及提供search-as-you-type、 did-you-mean 等\n搜索建议功能。")]),s._v(" "),t("li",[s._v("英国卫报使⽤Elasticsearch来处理访客⽇志，以便能将公众对不同⽂章的反应实时地反馈给各位编辑。")]),s._v(" "),t("li",[s._v("StackOverflow将全⽂搜索与地理位置和相关信息进⾏结合，以提供more-like-this相关问题的展现。")]),s._v(" "),t("li",[s._v("GitHub使⽤Elasticsearch来检索超过1300亿⾏代码。")]),s._v(" "),t("li",[s._v("Goldman Sachs使⽤它来处理5TB数据的索引，还有很多投⾏使⽤它来分析股票市场的变动")])]),s._v(" "),t("h2",{attrs:{id:"_4、elasticsearch逻辑结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、elasticsearch逻辑结构"}},[s._v("#")]),s._v(" 4、Elasticsearch逻辑结构")]),s._v(" "),t("blockquote",[t("p",[s._v("集群--\x3eindex(索引)--\x3etypes(类型)--\x3edocument(⽂档)--\x3efield(字段)")])]),s._v(" "),t("h3",{attrs:{id:"_4-1、索引-index"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1、索引-index"}},[s._v("#")]),s._v(" 4.1、索引（index）")]),s._v(" "),t("p",[s._v("索引是ElasticSearch存放数据的地⽅，可以理解为关系型数据库中的⼀个数据库。")]),s._v(" "),t("p",[s._v("事实上，我们的数据被存储和索引 在分⽚(shards)中，索引只是⼀个把⼀个或多个分⽚分组在⼀起的逻辑空间。然\n⽽，这只是⼀些内部细节——我们的 程序完全不⽤关⼼分⽚。对于我们的程序⽽⾔，⽂档存储在索引(index)中。剩\n下的细节由Elasticsearch关⼼既可。")]),s._v(" "),t("p",[t("code",[s._v("索引的名字必须是全部⼩写，不能以下划线开头，不能包含逗号")])]),s._v(" "),t("h3",{attrs:{id:"_4-2、类型-type"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2、类型-type"}},[s._v("#")]),s._v(" 4.2、类型（type）")]),s._v(" "),t("p",[s._v("类型⽤于区分同⼀个索引下不同的数据类型,相当于关系型数据库中的表。在Elasticsearch中，我们使⽤相同类型\n(type)的⽂档表示相同的“事物”，因为他们的数据结构也是相同的。每个类型(type)都有⾃⼰的映射(mapping)或者\n结 构定义，就像传统数据库表中的列⼀样。所有类型下的⽂档被存储在同⼀个索引下，但是类型的映射(mapping)\n会告 诉Elasticsearch不同的⽂档如何被索引。")]),s._v(" "),t("p",[t("code",[s._v("es 6.0 开始不推荐⼀个index下多个type的模式，并且会在 7.0 中完全移除。在7.0 的index下是⽆法创建多个type")])]),s._v(" "),t("h3",{attrs:{id:"_4-3、文档-documents"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3、文档-documents"}},[s._v("#")]),s._v(" 4.3、文档（documents）")]),s._v(" "),t("p",[s._v("⽂档是ElasticSearch中存储的实体，类⽐关系型数据库，每个⽂档相当于数据库表中的⼀⾏数据。 在Elasticsearch\n中，⽂档(document)这个术语有着特殊含义。它特指最顶层结构或者根对象(root object)序列化成的JSON数据（以\n唯⼀ID标识并存储于Elasticsearch中）。")]),s._v(" "),t("h3",{attrs:{id:"_4-4、字段-fields"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4、字段-fields"}},[s._v("#")]),s._v(" 4.4、字段（fields）")]),s._v(" "),t("p",[s._v("⽂档由字段组成，相当于关系数据库中列的属性，不同的是ES的不同⽂档可以具有不同的字段集合。")]),s._v(" "),t("h3",{attrs:{id:"_4-5、节点与集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-5、节点与集群"}},[s._v("#")]),s._v(" 4.5、节点与集群")]),s._v(" "),t("p",[s._v("⼀个集群是由⼀个或多个节点组成的集合，集群上的节点将会存储数据，并提供跨节点的索引和搜索功能。\n集群通过⼀个唯⼀的名称作为标识，节点通过设置集群名称就可以加⼊相应的集群，当然这需要节点所在的⽹络能\n够发现集群。所以要注意在同⼀个⽹络中，不同环境、服务的集群的名称不能重复。")]),s._v(" "),t("p",[s._v("⼀个节点就是⼀个 Elasticsearch 服务 （实例），可以实现存储数据，索引并且搜索的功能。和集群⼀样，每个节\n点都有⼀个唯⼀的名称作为身份标识，如果没有设置名称，默认使⽤ UUID 作为名称。如果想更好的管理集群，最\n好给每个节点都定义上有意义的名称，在集群中区分出各个节点。节点通过设置集群名称，在同⼀⽹络中发现具有\n相同集群名称的节点，组成集群。默认的集群名称为 elasticsearch 。")]),s._v(" "),t("p",[s._v("如果在同⼀⽹络中只有⼀个节点，则这个节点成为⼀个单节点集群，换句话说就是每个节点都是功能⻬全的服务。")]),s._v(" "),t("h2",{attrs:{id:"_5、elasticsearch安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5、elasticsearch安装"}},[s._v("#")]),s._v(" 5、Elasticsearch安装")]),s._v(" "),t("h3",{attrs:{id:"_5-1、elastic-和-elasticsearch"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1、elastic-和-elasticsearch"}},[s._v("#")]),s._v(" 5.1、Elastic 和 Elasticsearch")]),s._v(" "),t("p",[s._v("Elastic官⽹： https://www.elastic.co/cn/\nElastic有⼀条完整的产品线及解决⽅案： Elasticsearch、 Logstash、 Kibana等，这三个就是⼤家常说的ELK技术栈。")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101161024646","data-src":"https://s2.loli.net/2022/01/01/r2gxXQ1nMfkUq9j.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("Elasticsearch官⽹： https://www.elastic.co/cn/products/elasticsearch")]),s._v(" "),t("h3",{attrs:{id:"_5-2、linux下安装es"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2、linux下安装es"}},[s._v("#")]),s._v(" 5.2、Linux下安装ES")]),s._v(" "),t("blockquote",[t("p",[s._v("出于安全考虑， elasticsearch默认不允许以root账号运⾏")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("创建⽤户设置密码")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# useradd es")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# passwd es")]),s._v("\nChanging password "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user es.\nNew password: 6610root\nRetype new password:\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chmod 777 /usr/local 【授予es⽤户/usr/local⽬录 可读可写可执⾏权限】")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# su - es")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("es@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("检查JDK版本(需要JDK1.8+)")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("es@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# java -version")]),s._v("\nopenjdk version "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.8.0_222-ea"')]),s._v("\nOpenJDK Runtime Environment "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("build "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.8")]),s._v(".0_222-ea-b03"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("ll\nOpenJDK "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("-Bit Server VM "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("build "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25.222")]),s._v("-b03, mixed mode"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("将ES的压缩包上传⾄ /usr/local ⽬录并解压")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("es@localhost local"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf elasticsearch-7.6.1-linux-x86_64.tar.gz\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("查看配置文件")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("es@localhost local"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd elasticsearch-7.6.1/config/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("es@localhost config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nelasticsearch.yml jvm.options log4j2.properties role_mapping.yml roles.yml "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v("\nusers_roles\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("修改jvm.options")]),s._v(" "),t("p",[s._v("Elasticsearch基于Lucene的，⽽Lucene底层是java实现，因此我们需要配置jvm参数")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("es@localhost config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim jvm.options")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认配置如下")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Xms represents the initial size of total heap space")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Xmx represents the maximum size of total heap space")]),s._v("\n-Xms1g\n-Xmx1g\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("修改 elasticsearch.yml")]),s._v(" "),t("ul",[t("li",[s._v("修改集群节点信息")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ---------------------------------- Cluster -----------------------------------17")]),s._v("\ncluster.name: my-application\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ------------------------------------ Node ------------------------------------23")]),s._v("\nnode.name: node-1\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --------------------------------- Discovery ----------------------------------72")]),s._v("\ncluster.initial_master_nodes: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node-1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("ul",[t("li",[s._v("修改数据⽂件和⽇志⽂件存储⽬录路径（如果⽬录不存在则需创建）")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim elasticsearch.yml")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ---------------------------- Paths ------------------------------")]),s._v("\npath.data: /usr/local/elasticsearch-7.6.1/data\n\npath.logs: /usr/local/elasticsearch-7.6.1/logs\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ul",[t("li",[s._v("修改绑定的ip，默认只允许本机访问，修改为0.0.0.0后则可以远程访问")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ---------------------------- Network ------------------------------")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认只允许本机访问，修改为0.0.0.0后则可以远程访问")]),s._v("\nnetwork.host: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("ul",[t("li",[t("p",[s._v("配置信息说明")]),s._v(" "),t("p",[s._v("⽬前我们是做的单机安装，如果要做集群，只需要在这个配置⽂件中添加其它节点信息即可。")])])])])]),s._v(" "),t("p",[s._v("​\t\t"),t("img",{staticClass:"lazy",attrs:{alt:"image-20220101161558931","data-src":"https://s2.loli.net/2022/01/01/VFyiHS3pkfwlDOQ.png",loading:"lazy"}})]),s._v(" "),t("ul",[t("li",[t("p",[s._v("进⼊elasticsearch/bin⽬录运⾏")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("es@localhost elasticsearch-7.6.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /usr/local/elasticsearch-7.6.1/bin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("es@localhost elasticsearch-7.6.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./elasticsearch")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("* soft nofile "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("666666666")]),s._v("\n* hard nofile "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("131072")]),s._v("\n* soft nproc "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n* hard nproc "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])])]),s._v(" "),t("h3",{attrs:{id:"_5-3、启动错误问题总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3、启动错误问题总结"}},[s._v("#")]),s._v(" 5.3、启动错误问题总结")]),s._v(" "),t("h4",{attrs:{id:"_5-3-1、错误1-内核过低"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-1、错误1-内核过低"}},[s._v("#")]),s._v(" 5.3.1、错误1：内核过低")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101161742315","data-src":"https://s2.loli.net/2022/01/01/SeCpdN4IYD6tghu.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("我们使⽤的是centos6，其linux内核版本为2.6。⽽Elasticsearch的插件要求⾄少3.5以上版本。不过没关系，我们禁\n⽤这个插件即可。")]),s._v(" "),t("p",[s._v("修改elasticsearch.yml⽂件，在最下⾯添加如下配置：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("bootstrap.system_call_filter: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("然后重启")]),s._v(" "),t("h4",{attrs:{id:"_5-3-2、错误2-文件权限不足"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-2、错误2-文件权限不足"}},[s._v("#")]),s._v(" 5.3.2、错误2：文件权限不足")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101161902760","data-src":"https://s2.loli.net/2022/01/01/ZLvF9Mz847AaG1k.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("我们⽤的是es⽤户，⽽不是root，所以⽂件权限不⾜。")]),s._v(" "),t("p",[s._v("⾸先⽤root⽤户登录,然后修改配置⽂件:")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/security/limits.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("添加下⾯的内容：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("* soft nofile "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v("\n* hard nofile "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("131072")]),s._v("\n* soft nproc "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n* hard nproc "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h4",{attrs:{id:"_5-3-3、错误3-线程数不够"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-3、错误3-线程数不够"}},[s._v("#")]),s._v(" 5.3.3、错误3：线程数不够")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[1]: max number of threads [1024] for user [es] is too low, increase to at least [4096]\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这是线程数不够")]),s._v(" "),t("p",[s._v("继续修改配置")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/security/limits.d/20-nproc.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("修改下面的内容")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("soft nproc "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("改为")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("soft nproc "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"_5-3-4、错误4-进程虚拟内存"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-4、错误4-进程虚拟内存"}},[s._v("#")]),s._v(" 5.3.4、错误4：进程虚拟内存")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": max virtual memory areas vm.max_map_count "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65530")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" likely too low, increase to at least\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("262144")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("vm.max_map_count：限制⼀个进程可以拥有的VMA(虚拟内存区域)的数量")]),s._v(" "),t("p",[s._v("继续修改配置⽂件， vim /etc/sysctl.conf 添加下⾯内容：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("vm.max_map_count"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("655360")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("修改完成之后在终端执行")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##然后执⾏命令")]),s._v("\nsysctl -p\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h4",{attrs:{id:"_5-3-5、错误5-未设置节点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-5、错误5-未设置节点"}},[s._v("#")]),s._v(" 5.3.5、错误5：未设置节点")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("the default discovery settings are unsuitable "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" production use"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" at least one of\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("discovery.seed_ho"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("修改elasticsearch.yml")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("cluster.name: my-application\nnode.name: node-1\ncluster.initial_master_nodes: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node-1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"_6、安装kibana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6、安装kibana"}},[s._v("#")]),s._v(" 6、安装Kibana")]),s._v(" "),t("p",[s._v("Kibana是⼀个基于Node.js的Elasticsearch索引库数据统计⼯具，可以利⽤Elasticsearch的聚合功能，⽣成各种图\n表，如柱形图，线状图，饼图等。")]),s._v(" "),t("p",[s._v("⽽且还提供了操作Elasticsearch索引数据的控制台，并且提供了⼀定的API提示，⾮常有利于我们学习Elasticsearch\n的语法。")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101162440638","data-src":"https://s2.loli.net/2022/01/01/LDxBcWXdpYAHNEu.png",loading:"lazy"}})]),s._v(" "),t("h3",{attrs:{id:"_6-1、安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-1、安装"}},[s._v("#")]),s._v(" 6.1、安装")]),s._v(" "),t("ul",[t("li",[s._v("kibana版本与elasticsearch保持⼀致，也是7.6.1解压到特定⽬录即可")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf kibana-7.6.1-linux-x86_64.tar.gz\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_6-2、配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-2、配置"}},[s._v("#")]),s._v(" 6.2、配置")]),s._v(" "),t("ul",[t("li",[s._v("进⼊安装⽬录下的config⽬录，修改kibana.yml⽂件：")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("server.port: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5601")]),s._v("\nserver.host: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0.0"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"_6-3、运行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-3、运行"}},[s._v("#")]),s._v(" 6.3、运行")]),s._v(" "),t("p",[s._v("进⼊安装⽬录下的bin⽬录启动：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("./kibana\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("发现kibana的监听端⼝是5601")]),s._v(" "),t("p",[s._v("我们访问： http://8.130.18.255:5601")]),s._v(" "),t("h3",{attrs:{id:"_6-4、控制台"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-4、控制台"}},[s._v("#")]),s._v(" 6.4、控制台")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101162647982","data-src":"https://s2.loli.net/2022/01/01/hsxSoHRiElbzNM5.png",loading:"lazy"}})]),s._v(" "),t("h2",{attrs:{id:"_7、安装ik分词器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7、安装ik分词器"}},[s._v("#")]),s._v(" 7、安装IK分词器")]),s._v(" "),t("h3",{attrs:{id:"_7-1、安装ik分词器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-1、安装ik分词器"}},[s._v("#")]),s._v(" 7.1、安装ik分词器")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101162747123","data-src":"https://s2.loli.net/2022/01/01/TfWL9kqFoH7UidI.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("分词器配置完成以后，重启es")]),s._v(" "),t("h3",{attrs:{id:"_7-2、测试分词器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-2、测试分词器"}},[s._v("#")]),s._v(" 7.2、测试分词器")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101162809783","data-src":"https://s2.loli.net/2022/01/01/MiHA4IsPt7EhRov.png",loading:"lazy"}})]),s._v(" "),t("h3",{attrs:{id:"_7-3、配置自定义词库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-3、配置自定义词库"}},[s._v("#")]),s._v(" 7.3、配置⾃定义词库")]),s._v(" "),t("ul",[t("li",[s._v("在elasticsearch-analysis-ik-7.6.1/plugins/ik/config⽬录中定义词典⽂件（.dic）")]),s._v(" "),t("li",[s._v("在词典⽂件中定义⾃定义词汇")]),s._v(" "),t("li",[s._v("elasticsearch-analysis-ik-7.6.1/plugins/ik/config/IKAnalyzer.cfg.xml加载⾃定义词典⽂件")])]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token prolog"}},[s._v('<?xml version="1.0" encoding="UTF-8"?>')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token doctype"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<!")]),t("span",{pre:!0,attrs:{class:"token doctype-tag"}},[s._v("DOCTYPE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token name"}},[s._v("properties")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token name"}},[s._v("SYSTEM")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://java.sun.com/dtd/properties.dtd"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("properties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("comment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("IK Analyzer 扩展配置"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("comment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--⽤户可以在这⾥配置⾃⼰的扩展字典 --\x3e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("entry")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("key")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("ext_dict"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("mywords.dic"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("entry")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--⽤户可以在这⾥配置⾃⼰的扩展停⽌词字典--\x3e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("entry")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("key")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("ext_stopwords"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("entry")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--⽤户可以在这⾥配置远程扩展字典 --\x3e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('\x3c!-- <entry key="remote_ext_dict">words_location</entry> --\x3e')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--⽤户可以在这⾥配置远程扩展停⽌词字典--\x3e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('\x3c!-- <entry key="remote_ext_stopwords">words_location</entry> --\x3e')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("properties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h2",{attrs:{id:"_8、es基本操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8、es基本操作"}},[s._v("#")]),s._v(" 8、ES基本操作")]),s._v(" "),t("h3",{attrs:{id:"_8-1、es是基于restful实现访问"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-1、es是基于restful实现访问"}},[s._v("#")]),s._v(" 8.1、ES是基于RESTful实现访问")]),s._v(" "),t("p",[s._v("ES是⽀持web访问的，但必须遵从RESTful访问规范")]),s._v(" "),t("p",[t("strong",[s._v("ES逻辑结构")])]),s._v(" "),t("ul",[t("li",[s._v("数据库：数据是存储在数据表中的，数据表是创建在数据库中的")]),s._v(" "),t("li",[s._v("ES： document是存储在type中的， type是创建在index中\n"),t("ul",[t("li",[s._v("index 索引 --- 相当于数据库 （索引的命名不能包含特殊字符，必须⼩写）")]),s._v(" "),t("li",[s._v("type类型 --- 相当于数据表 （在es7以前，⼀个index中可以创建多个type ）")]),s._v(" "),t("li",[s._v("document⽂档 --- 相当于数据表中的⼀条记录")])])])]),s._v(" "),t("p",[t("strong",[s._v("RESTful")])]),s._v(" "),t("ul",[t("li",[s._v("不同操作需要使⽤不同的请求⽅式")]),s._v(" "),t("li",[s._v("基于REST的基本访问规范")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("请求方式")]),s._v(" "),t("th",[s._v("REST请求")]),s._v(" "),t("th",[s._v("功能描述")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("PUT")]),s._v(" "),t("td",[s._v("http://eshost:9200/index1")]),s._v(" "),t("td",[s._v("创建index(索引)")])]),s._v(" "),t("tr",[t("td",[s._v("POST")]),s._v(" "),t("td",[s._v("http://eshost:9200/索引名/类型名/⽂档ID")]),s._v(" "),t("td",[s._v("添加document")])]),s._v(" "),t("tr",[t("td",[s._v("POST")]),s._v(" "),t("td",[s._v("http://eshost:9200/索引名/类型名/⽂档ID/_update")]),s._v(" "),t("td",[s._v("修改document⽂档")])]),s._v(" "),t("tr",[t("td",[s._v("DELETE")]),s._v(" "),t("td",[s._v("http://eshost:9200/索引名/类型名/⽂档ID")]),s._v(" "),t("td",[s._v("根据ID删除document")])]),s._v(" "),t("tr",[t("td",[s._v("GET")]),s._v(" "),t("td",[s._v("http://eshost:9200/索引名/类型名/⽂档ID")]),s._v(" "),t("td",[s._v("根据ID查询document")])]),s._v(" "),t("tr",[t("td",[s._v("POST")]),s._v(" "),t("td",[s._v("http://eshost:9200/索引名/类型名/_search")]),s._v(" "),t("td",[s._v("查询索引下所有数据")])])])]),s._v(" "),t("h3",{attrs:{id:"_8-2、基本操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-2、基本操作"}},[s._v("#")]),s._v(" 8.2、基本操作")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("创建索引")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 【基本操作】")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.创建索引 PUT")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("PUT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index1")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("PUT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index3")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "mappings"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "properties"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "book_id"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"long"')]),s._v("\n      },\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "book_name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('         "type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"text"')]),s._v("\n      },\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "book_author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('         "type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"keyword"')]),s._v("\n      },\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "book_price"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('         "type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"float"')]),s._v("\n      },\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "book_desc"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('         "type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"text"')]),s._v("\n      }\n    }\n  }\n}\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 索引是⼀个逻辑单元， ES中的数据实际上是存储在分⽚中的,我们可以在settings中设置索引的属性")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("PUT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index2")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "settings"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "number_of_shards"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("2")]),s._v("\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("查询索引")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询索引信息")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询索引的mappings信息")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index1/_mappings")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询索引的属性设置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index1/_settings")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("创建⽂档：新增⼀条记录到ES")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("POST")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index3/_doc/101")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_id"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("101,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Java程序设计",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"千锋亮哥",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_price"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("22.22,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_desc"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"这是⼀本看了就会的Java秘籍"')]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("POST")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index3/_doc/102")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_id"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("102,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"C++程序设计",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"谭浩强",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_price"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("22.22,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_desc"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"C++程序设计中的名著"')]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("POST")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index3/_doc/103")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_id"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("103,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Python王者归来",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"杰哥",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_price"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("33.22,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_desc"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Python从⼊⻔到放弃"')]),s._v("\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("p",[s._v("注意： 在ES 7.0版本以后，⼀个index中只能存在⼀个type(默认名称为_doc)")])]),s._v(" "),t("li",[t("p",[s._v("修改⽂档：修改记录")]),s._v(" "),t("ul",[t("li",[s._v("使⽤新增操作的请求覆盖原记录")])]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("POST")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index3/_doc/103")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_id"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("103,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Python王者归来",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"杰哥",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_price"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("33.22,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "book_desc"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Python从⼊⻔到放弃"')]),s._v("\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("ul",[t("li",[s._v("使⽤_update修改")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('POST index3/_doc/103/_update\n{\n  "book_id":103,\n  "book_name":"Python王者归来",\n  "book_author":"杰哥",\n  "book_price":33.22,\n  "book_desc":"Python从⼊⻔到放弃"\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("查询⽂档")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#根据⽂档id查询数据")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index3/_doc/101")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查询索引中的所有数据（type使⽤⾃定名称）")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("POST")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index3/_doc/_search")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("删除⽂档")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("DELETE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index3/_doc/103")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("查看es状态_cat")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("_cat/indices?v")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("_cat/health?v")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])]),s._v(" "),t("h3",{attrs:{id:"_8-3、数据类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-3、数据类型"}},[s._v("#")]),s._v(" 8.3、数据类型")]),s._v(" "),t("blockquote",[t("p",[s._v("es中⼀个document表示⼀条记录，记录中field值的存储是有类型的")])]),s._v(" "),t("p",[s._v("https://www.elastic.co/guide/en/elasticsearch/reference/6.5/mapping-types.html")]),s._v(" "),t("p",[t("strong",[s._v("string")])]),s._v(" "),t("ul",[t("li",[s._v("text 可分词")]),s._v(" "),t("li",[s._v("keyword 不能分词")])]),s._v(" "),t("p",[t("strong",[s._v("Numeric datatypes")])]),s._v(" "),t("p",[t("code",[s._v("long , integer , short , byte , double , float , half_float , scaled_float")])]),s._v(" "),t("p",[t("strong",[s._v("Date datatype")])]),s._v(" "),t("ul",[t("li",[s._v("data --- ⽇期的存储时以 long 类型存储的毫秒数")])]),s._v(" "),t("p",[t("strong",[s._v("Boolean datatype")])]),s._v(" "),t("ul",[t("li",[s._v('boolean --- true | false | "true" | "false"')])]),s._v(" "),t("p",[t("strong",[s._v("Binary datatype")])]),s._v(" "),t("ul",[t("li",[s._v("binary 基于base64编码的字符串")])]),s._v(" "),t("p",[t("strong",[s._v("Range datatypes")])]),s._v(" "),t("p",[t("code",[s._v("integer_range , float_range , long_range , double_range , date_range")])]),s._v(" "),t("p",[t("strong",[s._v("创建Index并指定field类型")])]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("PUT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index3")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "mappings"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "properties"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "bookId"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"long"')]),s._v("\n      },\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"text"')]),s._v("\n      },\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"keyword"')]),s._v("\n      },\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "time"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"date"')]),s._v("\n      }\n    }\n  }\n}\n\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index3/_doc/_search")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("POST")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index3/_doc/1")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "bookId"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("10001,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Java程序设计",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"张三",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "time"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("234567890")]),s._v("\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h3",{attrs:{id:"_8-4、复杂查询-数据搜索"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-4、复杂查询-数据搜索"}},[s._v("#")]),s._v(" 8.4、复杂查询-数据搜索")]),s._v(" "),t("h5",{attrs:{id:"_8-4-1、数据准备"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-1、数据准备"}},[s._v("#")]),s._v(" 8.4.1、数据准备")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("PUT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index4")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "mappings"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "properties"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "bookId"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"long"')]),s._v("\n      },\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"text"')]),s._v("\n      },\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"keyword"')]),s._v("\n      },\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "time"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"date"')]),s._v("\n      }\n    }\n  }\n}\n\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("POST")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index4/_doc/1")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "bookId"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("10001,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Java程序设计",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"张三",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "time"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("234567890")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("POST")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index4/_doc/2")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "bookId"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("10002,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"C语⾔程序设计",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Java谭浩强",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "time"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("2345678999")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("POST")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index4/_doc/3")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "bookId"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("10003,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"程序设计进阶",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"李三",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "time"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("2345678222")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("POST")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("index4/_doc/4")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "bookId"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("10004,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Java编程思想",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"三⽑",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "time"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("23456783452")]),s._v("\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br")])]),t("h5",{attrs:{id:"_8-4-2、复杂查询语法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-2、复杂查询语法"}},[s._v("#")]),s._v(" 8.4.2、复杂查询语法")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"image-20220101164515364","data-src":"https://s2.loli.net/2022/01/01/cXCzfa5ohN18Rtv.png",loading:"lazy"}})]),s._v(" "),t("h5",{attrs:{id:"_8-4-3、term和terms"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-3、term和terms"}},[s._v("#")]),s._v(" 8.4.3、term和terms")]),s._v(" "),t("blockquote",[t("p",[s._v("⽤于对keyword字段进⾏精确匹配")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("term 表示完全匹配，搜索之前不会对关键字进⾏分词")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index3/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "term"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"涛哥"')]),s._v("\n    }\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("terms 也表示完全匹配，可以为⼀个field指定多个匹配关键词")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index3/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "terms"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('["涛哥","李三"]')]),s._v("\n    }\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])])])]),s._v(" "),t("h5",{attrs:{id:"_8-4-4、match查询-重点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-4、match查询-重点"}},[s._v("#")]),s._v(" 8.4.4、match查询（重点）")]),s._v(" "),t("blockquote",[t("p",[s._v("match查询表示对text字段进⾏部分匹配（模糊查询）")])]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("match 表示部分匹配，搜索之前会对关键词进⾏分词")])]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index4/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "match"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Java程序"')]),s._v("\n    }\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("match_all 表示查询全部内容，不指定任何条件")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index4/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "match_all"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{}")]),s._v("\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])]),s._v(" "),t("li",[t("p",[t("code",[s._v("multi_match 在多个字段中匹配同⼀个关键字")])]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index4/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "multi_match"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Java",')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "fields"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('["bookName","author"]')]),s._v("\n    }\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])])])]),s._v(" "),t("h5",{attrs:{id:"_8-4-5、根据id查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-5、根据id查询"}},[s._v("#")]),s._v(" 8.4.5、根据id查询")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("根据⼀个id查询⼀个document")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index4/_doc/1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("根据多个id查询多个document ==> select * from ... where id in [1,2,3]")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index4/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "ids"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "values"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('["1","2","3"]')]),s._v("\n    }\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])])])]),s._v(" "),t("h5",{attrs:{id:"_8-4-6、其他查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-6、其他查询"}},[s._v("#")]),s._v(" 8.4.6、其他查询")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("prefix查询，根据指定字段的前缀值进⾏查询")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index4/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "prefix"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "value"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"张"')]),s._v("\n      }\n    }\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("fuzzy查询，模糊查询，输⼊⼤概的内容es检索相关的数据")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index4/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "fuzzy"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "value"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"jav"')]),s._v("\n      }\n    }\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("wildcard查询：正则匹配")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index4/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "wildcard"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "value"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"张*"')]),s._v("\n      }\n    }\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("range查询，根据范围进⾏查询")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index4/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "range"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "bookId"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "gt"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("10001,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('        "lte"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("10003")]),s._v("\n      }\n    }\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("分⻚查询")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index4/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "match_all"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{}")]),s._v("\n  },\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "_source"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('["bookId","bookName"],')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "from"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("0,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "size"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("20")]),s._v("\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])])])]),s._v(" "),t("h4",{attrs:{id:"_8-5、复合查询-bool"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-5、复合查询-bool"}},[s._v("#")]),s._v(" 8.5、复合查询—bool")]),s._v(" "),t("blockquote",[t("p",[s._v("复合查询——多条件查询\nshould ==> or\nmust ==> and\nmust_not ==> not")])]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index4/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "bool"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "must_not"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("[")]),s._v("\n        {\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('          "match"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('            "bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Java"')]),s._v("\n          }\n        },\n        {\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('          "match"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('            "author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"张三"')]),s._v("\n          }\n        }\n      ]\n    }\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("h4",{attrs:{id:"_8-6、结果过滤-filter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-6、结果过滤-filter"}},[s._v("#")]),s._v(" 8.6、结果过滤—filter")]),s._v(" "),t("blockquote",[t("p",[s._v("filter——根据条件进⾏查询，不计算分数，会对经常被过滤的数据进⾏缓存")])]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index3/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "bool"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "filter"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("[")]),s._v("\n        {\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('          "match"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('            "bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Java"')]),s._v("\n          }\n        },\n        {\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('          "match"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('            "author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"张三"')]),s._v("\n          }\n        }\n      ]\n    }\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("h4",{attrs:{id:"_8-7、高亮显示-重点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-7、高亮显示-重点"}},[s._v("#")]),s._v(" 8.7、高亮显示（重点）")]),s._v(" "),t("blockquote",[t("p",[s._v("对匹配的关键词进⾏特殊样式的标记")])]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("GET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/index3/_search")]),s._v("\n{\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "match"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"Java"')]),s._v("\n    }\n  },\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('  "highlight"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "fields"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('      "bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("{}")]),s._v("\n    },\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "pre_tags"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("\"<label style='color:red'>\",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v('    "post_tags"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('"</label>"')]),s._v("\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h2",{attrs:{id:"_9、springboot整合es"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9、springboot整合es"}},[s._v("#")]),s._v(" 9、SpringBoot整合ES")]),s._v(" "),t("p",[s._v("官⽅参考地址 https://www.elastic.co/guide/en/elasticsearch/client/index.html")]),s._v(" "),t("ul",[t("li",[s._v("RestLowerLevelClient")]),s._v(" "),t("li",[s._v("RestHighLevelClient")])]),s._v(" "),t("h3",{attrs:{id:"_9-1、创建springboot应用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-1、创建springboot应用"}},[s._v("#")]),s._v(" 9.1、创建SpringBoot应用")]),s._v(" "),t("p",[s._v("略")]),s._v(" "),t("h3",{attrs:{id:"_9-2、添加es的依赖"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-2、添加es的依赖"}},[s._v("#")]),s._v(" 9.2、添加es的依赖")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter-data-elasticsearch"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"_9-3、配置bean"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-3、配置bean"}},[s._v("#")]),s._v(" 9.3、配置Bean")]),s._v(" "),t("p",[s._v("创建ElasticSearchConfig，并编写内容")]),s._v(" "),t("blockquote",[t("p",[s._v("在springboot应⽤中已经提供了RestHighLevelClient实例，⽆需进⾏实例配置，但是需要进⾏es服务器地址配\n置")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Bean")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RestHighLevelClient")]),s._v(" getRe "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stHighLevelClient")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpHost")]),s._v(" httpHost "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpHost")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"47.96.11.185"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RestClientBuilder")]),s._v(" restClientBuilder "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RestClient")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("builder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("httpHost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RestHighLevelClient")]),s._v(" restHighLevelClient "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RestHighLevelClient")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("restClientBuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" restHighLevelClient"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("在springboot应⽤配置连接：")]),s._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("  elasticsearch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("    rest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("      uris")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("http://47.96.11.185:9200")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"_9-4、使用案例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-4、使用案例"}},[s._v("#")]),s._v(" 9.4、使用案例")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SpringBootTest")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Esdemo3ApplicationTests")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \n\t"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Resource")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RestHighLevelClient")]),s._v(" restHighLevelClient"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n    * 在es中创建索引\n    */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testCreateIndex")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CreateIndexRequest")]),s._v(" createIndexRequest "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CreateIndexRequest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index4"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CreateIndexResponse")]),s._v(" createIndexResponse "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n        restHighLevelClient"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("indices")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("create")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("createIndexRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RequestOptions")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DEFAULT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("createIndexResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//System.out.println(createIndexResponse.isAcknowledged());")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n    * 删除索引\n    */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testDeleteIndex")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DeleteIndexRequest")]),s._v(" deleteIndexRequest "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DeleteIndexRequest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index4"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AcknowledgedResponse")]),s._v(" deleteIndexRes "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n        restHighLevelClient"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("indices")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("delete")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("deleteIndexRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RequestOptions")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DEFAULT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("deleteIndexRes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n    * 添加⽂档：将数据存⼊es\n    */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testCreateDocument")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Book")]),s._v(" book "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Book")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10005")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"平凡的世界"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"路遥"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Date")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getTime")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ObjectMapper")]),s._v(" objectMapper "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ObjectMapper")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" jsonStr "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" objectMapper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("writeValueAsString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("book"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IndexRequest")]),s._v(" request "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IndexRequest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index3"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10005"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("source")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jsonStr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("XContentType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("JSON"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IndexResponse")]),s._v(" indexResponse "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" restHighLevelClient"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("index")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RequestOptions")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DEFAULT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("indexResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n    * 搜索\n    */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testSearch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SearchRequest")]),s._v(" searchRequest "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SearchRequest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index3"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SearchSourceBuilder")]),s._v(" searchSourceBuilder "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SearchSourceBuilder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//分页查询")]),s._v("\n        searchSourceBuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("from")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        searchSourceBuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("size")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//查询条件")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// searchSourceBuilder.query(QueryBuilders.matchAllQuery());")]),s._v("\n        searchSourceBuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("query")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("QueryBuilders")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("matchQuery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Java"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        searchSourceBuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("query")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("QueryBuilders")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("multiMatchQuery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"奥利奥"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"productName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"productDesc"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("        \n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//高亮显示")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HighlightBuilder")]),s._v(" highlightBuilder "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HighlightBuilder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HighlightBuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Field")]),s._v(" highlightTitle "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HighlightBuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Field")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bookName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        highlightTitle"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("highlighterType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unified"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        highlightBuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("field")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("highlightTitle"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        highlightBuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("preTags")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"<label style='color:red'>\"")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        highlightBuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("postTags")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"</label>"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        searchSourceBuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("highlighter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("highlightBuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        searchRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("source")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("searchSourceBuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SearchResponse")]),s._v(" searchResp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" restHighLevelClient"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("search")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("searchRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RequestOptions")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DEFAULT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SearchHits")]),s._v(" hits "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" searchResp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getHits")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SearchHit")]),s._v(" hit "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" hits"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        \t"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("hit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br")])]),t("h5",{attrs:{id:"批量添加-参考代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#批量添加-参考代码"}},[s._v("#")]),s._v(" 批量添加（参考代码）")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n* 批量插⼊ES\n* @param indexName 索引\n* @param type 类型\n* @param idName id名称\n* @param list 数据集合\n*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bulkData")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" indexName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" type "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" idName "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" list\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" list "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("size")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isBlank")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("indexName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isBlank")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("idName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isBlank")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        \t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BulkRequest")]),s._v(" request "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BulkRequest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" map "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("map"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("idName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            \trequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IndexRequest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("indexName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" type"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("valueOf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("map"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("idName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("source")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("map"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("XContentType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("JSON"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2、可选的设置")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/*\n        request.timeout("2m");\n        request.setRefreshPolicy("wait_for");\n        request.waitForActiveShards(2);\n        */')]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//3、发送请求:同步请求")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BulkResponse")]),s._v(" bulkResponse "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" client"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bulk")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//4、处理响应")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bulkResponse "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BulkItemResponse")]),s._v(" bulkItemResponse "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" bulkResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DocWriteResponse")]),s._v(" itemResponse "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" bulkItemResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getResponse")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bulkItemResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getOpType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DocWriteRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("OpType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("INDEX\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" bulkItemResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getOpType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DocWriteRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("OpType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CREATE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IndexResponse")]),s._v(" indexResponse "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IndexResponse")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" itemResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//TODO 新增成功的处理")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"新增成功,{}"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" indexResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bulkItemResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getOpType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DocWriteRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("OpType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("UPDATE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UpdateResponse")]),s._v(" updateResponse "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UpdateResponse")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" itemResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//TODO 修改成功的处理")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"修改成功,{}"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" updateResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bulkItemResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getOpType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DocWriteRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("OpType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DELETE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DeleteResponse")]),s._v(" deleteResponse "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DeleteResponse")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" itemResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//TODO 删除成功的处理")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"删除成功,{}"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" deleteResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printStackTrace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br")])]),t("h5",{attrs:{id:"查询数据封装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查询数据封装"}},[s._v("#")]),s._v(" 查询数据封装")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Iterator")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SearchHit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" iterator "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hits"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("iterator")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Product")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" products "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("iterator"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hasNext")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SearchHit")]),s._v(" searchHit "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" iterator"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("next")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" str "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" searchHit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getSourceAsString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Product")]),s._v(" product "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" objectMapper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("readValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("str"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Product")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HighlightField")]),s._v(" highlightField "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" searchHit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getHighlightFields")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"productName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("highlightField "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" s "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Arrays")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("highlightField"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("fragments")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setProductName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    products"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);