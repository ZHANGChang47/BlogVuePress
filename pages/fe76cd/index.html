<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ElasticSearch | 百里登风的博客</title>
    <meta name="generator" content="VuePress 1.9.8">
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?e1aa9d15d62220ec692a843c08c79000";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>        
    </script>
    <script src="https://fastly.jsdelivr.net/npm/twikoo@1.5.11/dist/twikoo.all.min.js"></script>
    <script href="./js/index.js" async="async"></script>
    <link rel="icon" href="https://typora001-zc.oss-cn-chengdu.aliyuncs.com/typoraImg/personPhoto.webp">
    <script charset="utf-8" href="./js/main.js"></script>
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3077305_pt8umhrn4k9.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <meta name="description" content="张弓折扇风雨历，畅叙平生快意！">
    <meta name="image" content="https://s2.loli.net/2022/01/01/nXYOL9KCogFbZQt.png">
    <meta name="twitter:title" content="ElasticSearch">
    <meta name="twitter:description" content="">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://s2.loli.net/2022/01/01/nXYOL9KCogFbZQt.png">
    <meta name="twitter:url" content="https://frxcat.fun/07.%E7%BB%84%E4%BB%B6/05.ElasticSearch.html">
    <meta name="twitter:site" content="@frxcat">
    <meta property="og:type" content="article">
    <meta property="og:title" content="ElasticSearch">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://s2.loli.net/2022/01/01/nXYOL9KCogFbZQt.png">
    <meta property="og:url" content="https://frxcat.fun/07.%E7%BB%84%E4%BB%B6/05.ElasticSearch.html">
    <meta property="og:site_name" content="frxcat">
    <meta property="article:published_time" content="2023-02-03T23:06:45.000Z">
    <meta property="article:tag" content="null">
    <meta itemprop="name" content="ElasticSearch">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="https://s2.loli.net/2022/01/01/nXYOL9KCogFbZQt.png">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="baidu-site-verification" content="code-5aMKYEt9fV">
    <link rel="preload" href="/assets/css/0.styles.79be46fe.css" as="style"><link rel="preload" href="/assets/js/app.bb5e25c9.js" as="script"><link rel="preload" href="/assets/js/2.108e92a1.js" as="script"><link rel="preload" href="/assets/js/79.d4ff4d30.js" as="script"><link rel="preload" href="/assets/js/5.73b07204.js" as="script"><link rel="preload" href="/assets/js/13.9b1b1c77.js" as="script"><link rel="preload" href="/assets/js/14.e2f4930c.js" as="script"><link rel="preload" href="/assets/js/9.5b9b4ae3.js" as="script"><link rel="preload" href="/assets/js/10.68c0c324.js" as="script"><link rel="prefetch" href="/assets/js/11.ef1511e2.js"><link rel="prefetch" href="/assets/js/12.da9b2478.js"><link rel="prefetch" href="/assets/js/15.cd646c33.js"><link rel="prefetch" href="/assets/js/16.3ec04fab.js"><link rel="prefetch" href="/assets/js/17.6e9ef9cc.js"><link rel="prefetch" href="/assets/js/18.493ad1ad.js"><link rel="prefetch" href="/assets/js/19.e0f986d5.js"><link rel="prefetch" href="/assets/js/20.b8528c67.js"><link rel="prefetch" href="/assets/js/21.fad22d46.js"><link rel="prefetch" href="/assets/js/22.8b0c4122.js"><link rel="prefetch" href="/assets/js/23.3e372155.js"><link rel="prefetch" href="/assets/js/24.3b7e2a1d.js"><link rel="prefetch" href="/assets/js/25.9a80a2fa.js"><link rel="prefetch" href="/assets/js/26.a83bf322.js"><link rel="prefetch" href="/assets/js/27.592a3fdd.js"><link rel="prefetch" href="/assets/js/28.a8d69689.js"><link rel="prefetch" href="/assets/js/29.bb969429.js"><link rel="prefetch" href="/assets/js/3.c65ee6b2.js"><link rel="prefetch" href="/assets/js/30.7d78332c.js"><link rel="prefetch" href="/assets/js/31.3f6e4842.js"><link rel="prefetch" href="/assets/js/32.b52e67f7.js"><link rel="prefetch" href="/assets/js/33.1a666e7d.js"><link rel="prefetch" href="/assets/js/34.4b8f1385.js"><link rel="prefetch" href="/assets/js/35.87ca92cc.js"><link rel="prefetch" href="/assets/js/36.fc40f016.js"><link rel="prefetch" href="/assets/js/37.be3bf444.js"><link rel="prefetch" href="/assets/js/38.eeafc53c.js"><link rel="prefetch" href="/assets/js/39.f34be6d8.js"><link rel="prefetch" href="/assets/js/4.c0fd3b18.js"><link rel="prefetch" href="/assets/js/40.9791c200.js"><link rel="prefetch" href="/assets/js/41.020877c5.js"><link rel="prefetch" href="/assets/js/42.45c39e58.js"><link rel="prefetch" href="/assets/js/43.d9e8ef5e.js"><link rel="prefetch" href="/assets/js/44.464ccf3b.js"><link rel="prefetch" href="/assets/js/45.cb64e9da.js"><link rel="prefetch" href="/assets/js/46.0c9a8ead.js"><link rel="prefetch" href="/assets/js/47.a2e35d4f.js"><link rel="prefetch" href="/assets/js/48.098763ec.js"><link rel="prefetch" href="/assets/js/49.07c62b3b.js"><link rel="prefetch" href="/assets/js/50.fc5f88a3.js"><link rel="prefetch" href="/assets/js/51.e2f578ac.js"><link rel="prefetch" href="/assets/js/52.9e3e4056.js"><link rel="prefetch" href="/assets/js/53.f916bd38.js"><link rel="prefetch" href="/assets/js/54.e7c11e98.js"><link rel="prefetch" href="/assets/js/55.0e0a561a.js"><link rel="prefetch" href="/assets/js/56.b2f3577e.js"><link rel="prefetch" href="/assets/js/57.9e884be2.js"><link rel="prefetch" href="/assets/js/58.2fac2650.js"><link rel="prefetch" href="/assets/js/59.3b25f511.js"><link rel="prefetch" href="/assets/js/6.ed952e3d.js"><link rel="prefetch" href="/assets/js/60.bf607c06.js"><link rel="prefetch" href="/assets/js/61.d726e61a.js"><link rel="prefetch" href="/assets/js/62.edf6d32a.js"><link rel="prefetch" href="/assets/js/63.e30fdc11.js"><link rel="prefetch" href="/assets/js/64.922b4a17.js"><link rel="prefetch" href="/assets/js/65.9a3b347a.js"><link rel="prefetch" href="/assets/js/66.5ef4606b.js"><link rel="prefetch" href="/assets/js/67.d90678f1.js"><link rel="prefetch" href="/assets/js/68.91fa461c.js"><link rel="prefetch" href="/assets/js/69.1957f6af.js"><link rel="prefetch" href="/assets/js/7.355266c2.js"><link rel="prefetch" href="/assets/js/70.6ebb8af5.js"><link rel="prefetch" href="/assets/js/71.eee0b217.js"><link rel="prefetch" href="/assets/js/72.39ed8920.js"><link rel="prefetch" href="/assets/js/73.47121ddc.js"><link rel="prefetch" href="/assets/js/74.87a10f99.js"><link rel="prefetch" href="/assets/js/75.0b311495.js"><link rel="prefetch" href="/assets/js/76.268ef349.js"><link rel="prefetch" href="/assets/js/77.58de46fb.js"><link rel="prefetch" href="/assets/js/78.25b31166.js"><link rel="prefetch" href="/assets/js/8.f50cf6d8.js"><link rel="prefetch" href="/assets/js/80.c33be335.js"><link rel="prefetch" href="/assets/js/81.a24132da.js"><link rel="prefetch" href="/assets/js/82.00055c83.js"><link rel="prefetch" href="/assets/js/83.c39146f0.js"><link rel="prefetch" href="/assets/js/84.7c66fe01.js"><link rel="prefetch" href="/assets/js/85.c2a04d1e.js"><link rel="prefetch" href="/assets/js/86.b42a4e19.js"><link rel="prefetch" href="/assets/js/87.bdc4c3c8.js"><link rel="prefetch" href="/assets/js/88.deac45a6.js"><link rel="prefetch" href="/assets/js/89.8f2d6a69.js"><link rel="prefetch" href="/assets/js/90.e5dd302c.js"><link rel="prefetch" href="/assets/js/91.bbe5babf.js"><link rel="prefetch" href="/assets/js/92.74872263.js"><link rel="prefetch" href="/assets/js/93.8b3117a7.js"><link rel="prefetch" href="/assets/js/94.b33e3700.js"><link rel="prefetch" href="/assets/js/95.1ce3db13.js"><link rel="prefetch" href="/assets/js/96.6fda4bae.js">
    <link rel="stylesheet" href="/assets/css/0.styles.79be46fe.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">百里登风的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="散文随笔" class="dropdown-title"><!----> <span class="title" style="display:;">散文随笔</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/00.散文随笔/00.沧桑百年史，爱国西交情.html" class="nav-link">沧桑百年史，爱国西交情</a></li><li class="dropdown-item"><!----> <a href="/00.散文随笔/01.静谧之眼.html" class="nav-link">静谧之眼</a></li><li class="dropdown-item"><!----> <a href="/00.散文随笔/02.承党恩泽，物阜民丰.html" class="nav-link">承党恩泽，物阜民丰</a></li><li class="dropdown-item"><!----> <a href="/00.散文随笔/03.历边海防学院记.html" class="nav-link">历边海防学院记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java基础" class="dropdown-title"><!----> <span class="title" style="display:;">Java基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/01.Java基础/00.Java基础总结.html" class="nav-link">Java基础总结</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/01.Java开发介绍.html" class="nav-link">Java开发介绍</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/02.Java基础编程.html" class="nav-link">Java基础编程</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/03.方法与数组.html" class="nav-link">方法与数组</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/04.面向对象.html" class="nav-link">面向对象</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/05.异常处理.html" class="nav-link">异常处理</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/06.常用类库API.html" class="nav-link">常用类库API</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/07.文件IO操作.html" class="nav-link">文件IO操作</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/08.集合.html" class="nav-link">集合</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/09.多线程与并发.html" class="nav-link">多线程与并发</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/10.反射与内省.html" class="nav-link">反射与内省</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/11.泛型.html" class="nav-link">泛型</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/12.正则表达式.html" class="nav-link">正则表达式</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/13.枚举.html" class="nav-link">枚举</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/14.注解.html" class="nav-link">注解</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/15.GUI事件处理.html" class="nav-link">GUI事件处理</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/16.网络编程.html" class="nav-link">网络编程</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/17.JVM.html" class="nav-link">JVM</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/18.JUC.html" class="nav-link">JUC</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaWeb" class="dropdown-title"><!----> <span class="title" style="display:;">JavaWeb</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/02.JavaWeb/00.JavaWeb总结.html" class="nav-link">JavaWeb总结</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/01.Servlet.html" class="nav-link">Servlet</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/02.Web项目架构与数据库使用.html" class="nav-link">Web项目架构与数据库使用</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/03.Jsp与Listener.html" class="nav-link">Jsp与Listener</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/04.EL表达式与JSTL标签库.html" class="nav-link">EL表达式与JSTL标签库</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/05.文件的上传与下载.html" class="nav-link">文件的上传与下载</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/06.Web项目延伸完善.html" class="nav-link">Web项目延伸完善</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/07.cookie与session.html" class="nav-link">cookie与session</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/08.Filter与ThreadLocal.html" class="nav-link">Filter与ThreadLocal</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/09.i18n国际化.html" class="nav-link">i18n国际化</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/10.Web项目延伸完善(2).html" class="nav-link">Web项目延伸完善(2)</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Spring生态" class="dropdown-title"><!----> <span class="title" style="display:;">Spring生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/03.Spring生态/00.Spring.html" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/03.Spring生态/01.SpringMVC.html" class="nav-link">SpringMVC</a></li><li class="dropdown-item"><!----> <a href="/03.Spring生态/02.SpringBoot.html" class="nav-link">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/03.Spring生态/03.SpringCloud.html" class="nav-link">SpringCloud</a></li><li class="dropdown-item"><!----> <a href="/03.Spring生态/04.SpringSecurity.html" class="nav-link">SpringSecurity</a></li><li class="dropdown-item"><!----> <a href="/03.Spring生态/05.SpringSecurity与JWT.html" class="nav-link">SpringSecurity与JWT</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><!----> <span class="title" style="display:;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/04.前端/00.Html.html" class="nav-link">Html</a></li><li class="dropdown-item"><!----> <a href="/04.前端/01.Css.html" class="nav-link">Css</a></li><li class="dropdown-item"><!----> <a href="/04.前端/02.JavaScript.html" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/04.前端/03.jQuery.html" class="nav-link">jQuery</a></li><li class="dropdown-item"><!----> <a href="/04.前端/04.Vue1.md.html" class="nav-link">Vue1</a></li><li class="dropdown-item"><!----> <a href="/04.前端/04.Vue2.html" class="nav-link">Vue2</a></li><li class="dropdown-item"><!----> <a href="/04.前端/06.Vue2项目笔记.html" class="nav-link">Vue2项目笔记</a></li><li class="dropdown-item"><!----> <a href="/04.前端/07.Vue3项目笔记.html" class="nav-link">Vue3项目笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/05.数据库/00.MySQL.html" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/05.数据库/01.Redis.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/05.数据库/02.MyBatis.html" class="nav-link">MyBatis</a></li><li class="dropdown-item"><!----> <a href="/05.数据库/03.MyBatisPlus.html" class="nav-link">MyBatisPlus</a></li><li class="dropdown-item"><!----> <a href="/05.数据库/04.tkMapper.html" class="nav-link">tkMapper</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><!----> <span class="title" style="display:;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/06.工具/00.Linux.html" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/06.工具/01.Git.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/06.工具/02.Maven.html" class="nav-link">Maven</a></li><li class="dropdown-item"><!----> <a href="/06.工具/03.配置文件.html" class="nav-link">配置文件</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="组件" class="dropdown-title"><!----> <span class="title" style="display:;">组件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/07.组件/00.Json与XML.html" class="nav-link">Json与XML</a></li><li class="dropdown-item"><!----> <a href="/07.组件/01.Ajax.html" class="nav-link">Ajax</a></li><li class="dropdown-item"><!----> <a href="/07.组件/02.Log.html" class="nav-link">Log</a></li><li class="dropdown-item"><!----> <a href="/07.组件/03.Swagger.html" class="nav-link">Swagger</a></li><li class="dropdown-item"><!----> <a href="/07.组件/04.RabbitMQ.html" class="nav-link">RabbitMQ</a></li><li class="dropdown-item"><!----> <a href="/07.组件/05.ElasticSearch.html" class="nav-link">ElasticSearch</a></li><li class="dropdown-item"><!----> <a href="/07.组件/06.Gateway.html" class="nav-link">Gateway</a></li><li class="dropdown-item"><!----> <a href="/07.组件/07.分布式锁.html" class="nav-link">分布式锁</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><!----> <span class="title" style="display:;">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/08.项目/00.云E办/00.云E办后端笔记.html" class="nav-link">云E办后端笔记</a></li><li class="dropdown-item"><!----> <a href="/08.项目/00.云E办/01.云E办前端笔记.html" class="nav-link">云E办前端笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><!----> <span class="title" style="display:;">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/09.算法/00.算法入门.html" class="nav-link">算法入门</a></li><li class="dropdown-item"><!----> <a href="/09.算法/01.算法基础.html" class="nav-link">算法基础</a></li><li class="dropdown-item"><!----> <a href="/09.算法/02.排序算法.html" class="nav-link">排序算法</a></li><li class="dropdown-item"><!----> <a href="/09.算法/03.二分查找总结.html" class="nav-link">二分查找总结</a></li><li class="dropdown-item"><!----> <a href="/09.算法/04.全排列与子集.html" class="nav-link">全排列与子集</a></li><li class="dropdown-item"><!----> <a href="/09.算法/05.链表翻转.html" class="nav-link">链表翻转</a></li><li class="dropdown-item"><!----> <a href="/09.算法/06.Scanner在ACM模式下应用.html" class="nav-link">Scanner在ACM模式下应用</a></li><li class="dropdown-item"><!----> <a href="/09.算法/07.Utils工具类.html" class="nav-link">Utils工具类</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/ZHANGChang47/BlogVuePress" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://typora001-zc.oss-cn-chengdu.aliyuncs.com/typoraImg/personPhoto.webp"> <div class="blogger-info"><h3>百里登风</h3> <span>张弓折扇风雨历，畅叙平生快意!</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="散文随笔" class="dropdown-title"><!----> <span class="title" style="display:;">散文随笔</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/00.散文随笔/00.沧桑百年史，爱国西交情.html" class="nav-link">沧桑百年史，爱国西交情</a></li><li class="dropdown-item"><!----> <a href="/00.散文随笔/01.静谧之眼.html" class="nav-link">静谧之眼</a></li><li class="dropdown-item"><!----> <a href="/00.散文随笔/02.承党恩泽，物阜民丰.html" class="nav-link">承党恩泽，物阜民丰</a></li><li class="dropdown-item"><!----> <a href="/00.散文随笔/03.历边海防学院记.html" class="nav-link">历边海防学院记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java基础" class="dropdown-title"><!----> <span class="title" style="display:;">Java基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/01.Java基础/00.Java基础总结.html" class="nav-link">Java基础总结</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/01.Java开发介绍.html" class="nav-link">Java开发介绍</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/02.Java基础编程.html" class="nav-link">Java基础编程</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/03.方法与数组.html" class="nav-link">方法与数组</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/04.面向对象.html" class="nav-link">面向对象</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/05.异常处理.html" class="nav-link">异常处理</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/06.常用类库API.html" class="nav-link">常用类库API</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/07.文件IO操作.html" class="nav-link">文件IO操作</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/08.集合.html" class="nav-link">集合</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/09.多线程与并发.html" class="nav-link">多线程与并发</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/10.反射与内省.html" class="nav-link">反射与内省</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/11.泛型.html" class="nav-link">泛型</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/12.正则表达式.html" class="nav-link">正则表达式</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/13.枚举.html" class="nav-link">枚举</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/14.注解.html" class="nav-link">注解</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/15.GUI事件处理.html" class="nav-link">GUI事件处理</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/16.网络编程.html" class="nav-link">网络编程</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/17.JVM.html" class="nav-link">JVM</a></li><li class="dropdown-item"><!----> <a href="/01.Java基础/18.JUC.html" class="nav-link">JUC</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaWeb" class="dropdown-title"><!----> <span class="title" style="display:;">JavaWeb</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/02.JavaWeb/00.JavaWeb总结.html" class="nav-link">JavaWeb总结</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/01.Servlet.html" class="nav-link">Servlet</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/02.Web项目架构与数据库使用.html" class="nav-link">Web项目架构与数据库使用</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/03.Jsp与Listener.html" class="nav-link">Jsp与Listener</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/04.EL表达式与JSTL标签库.html" class="nav-link">EL表达式与JSTL标签库</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/05.文件的上传与下载.html" class="nav-link">文件的上传与下载</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/06.Web项目延伸完善.html" class="nav-link">Web项目延伸完善</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/07.cookie与session.html" class="nav-link">cookie与session</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/08.Filter与ThreadLocal.html" class="nav-link">Filter与ThreadLocal</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/09.i18n国际化.html" class="nav-link">i18n国际化</a></li><li class="dropdown-item"><!----> <a href="/02.JavaWeb/10.Web项目延伸完善(2).html" class="nav-link">Web项目延伸完善(2)</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Spring生态" class="dropdown-title"><!----> <span class="title" style="display:;">Spring生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/03.Spring生态/00.Spring.html" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/03.Spring生态/01.SpringMVC.html" class="nav-link">SpringMVC</a></li><li class="dropdown-item"><!----> <a href="/03.Spring生态/02.SpringBoot.html" class="nav-link">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/03.Spring生态/03.SpringCloud.html" class="nav-link">SpringCloud</a></li><li class="dropdown-item"><!----> <a href="/03.Spring生态/04.SpringSecurity.html" class="nav-link">SpringSecurity</a></li><li class="dropdown-item"><!----> <a href="/03.Spring生态/05.SpringSecurity与JWT.html" class="nav-link">SpringSecurity与JWT</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><!----> <span class="title" style="display:;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/04.前端/00.Html.html" class="nav-link">Html</a></li><li class="dropdown-item"><!----> <a href="/04.前端/01.Css.html" class="nav-link">Css</a></li><li class="dropdown-item"><!----> <a href="/04.前端/02.JavaScript.html" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/04.前端/03.jQuery.html" class="nav-link">jQuery</a></li><li class="dropdown-item"><!----> <a href="/04.前端/04.Vue1.md.html" class="nav-link">Vue1</a></li><li class="dropdown-item"><!----> <a href="/04.前端/04.Vue2.html" class="nav-link">Vue2</a></li><li class="dropdown-item"><!----> <a href="/04.前端/06.Vue2项目笔记.html" class="nav-link">Vue2项目笔记</a></li><li class="dropdown-item"><!----> <a href="/04.前端/07.Vue3项目笔记.html" class="nav-link">Vue3项目笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/05.数据库/00.MySQL.html" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/05.数据库/01.Redis.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/05.数据库/02.MyBatis.html" class="nav-link">MyBatis</a></li><li class="dropdown-item"><!----> <a href="/05.数据库/03.MyBatisPlus.html" class="nav-link">MyBatisPlus</a></li><li class="dropdown-item"><!----> <a href="/05.数据库/04.tkMapper.html" class="nav-link">tkMapper</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><!----> <span class="title" style="display:;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/06.工具/00.Linux.html" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/06.工具/01.Git.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/06.工具/02.Maven.html" class="nav-link">Maven</a></li><li class="dropdown-item"><!----> <a href="/06.工具/03.配置文件.html" class="nav-link">配置文件</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="组件" class="dropdown-title"><!----> <span class="title" style="display:;">组件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/07.组件/00.Json与XML.html" class="nav-link">Json与XML</a></li><li class="dropdown-item"><!----> <a href="/07.组件/01.Ajax.html" class="nav-link">Ajax</a></li><li class="dropdown-item"><!----> <a href="/07.组件/02.Log.html" class="nav-link">Log</a></li><li class="dropdown-item"><!----> <a href="/07.组件/03.Swagger.html" class="nav-link">Swagger</a></li><li class="dropdown-item"><!----> <a href="/07.组件/04.RabbitMQ.html" class="nav-link">RabbitMQ</a></li><li class="dropdown-item"><!----> <a href="/07.组件/05.ElasticSearch.html" class="nav-link">ElasticSearch</a></li><li class="dropdown-item"><!----> <a href="/07.组件/06.Gateway.html" class="nav-link">Gateway</a></li><li class="dropdown-item"><!----> <a href="/07.组件/07.分布式锁.html" class="nav-link">分布式锁</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><!----> <span class="title" style="display:;">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/08.项目/00.云E办/00.云E办后端笔记.html" class="nav-link">云E办后端笔记</a></li><li class="dropdown-item"><!----> <a href="/08.项目/00.云E办/01.云E办前端笔记.html" class="nav-link">云E办前端笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><!----> <span class="title" style="display:;">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/09.算法/00.算法入门.html" class="nav-link">算法入门</a></li><li class="dropdown-item"><!----> <a href="/09.算法/01.算法基础.html" class="nav-link">算法基础</a></li><li class="dropdown-item"><!----> <a href="/09.算法/02.排序算法.html" class="nav-link">排序算法</a></li><li class="dropdown-item"><!----> <a href="/09.算法/03.二分查找总结.html" class="nav-link">二分查找总结</a></li><li class="dropdown-item"><!----> <a href="/09.算法/04.全排列与子集.html" class="nav-link">全排列与子集</a></li><li class="dropdown-item"><!----> <a href="/09.算法/05.链表翻转.html" class="nav-link">链表翻转</a></li><li class="dropdown-item"><!----> <a href="/09.算法/06.Scanner在ACM模式下应用.html" class="nav-link">Scanner在ACM模式下应用</a></li><li class="dropdown-item"><!----> <a href="/09.算法/07.Utils工具类.html" class="nav-link">Utils工具类</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/ZHANGChang47/BlogVuePress" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/461e7b/" class="sidebar-link">Json与XML</a></li><li><a href="/pages/91b51f/" class="sidebar-link">Ajax</a></li><li><a href="/pages/345105/" class="sidebar-link">Log</a></li><li><a href="/pages/2d1eb8/" class="sidebar-link">Swagger</a></li><li><a href="/pages/e9816e/" class="sidebar-link">RabbitMQ</a></li><li><a href="/pages/fe76cd/" aria-current="page" class="active sidebar-link">ElasticSearch</a></li><li><a href="/pages/cbaa60/" class="sidebar-link">Gateway</a></li><li><a href="/pages/111f25/" class="sidebar-link">分布式锁</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1baff76c><div class="articleInfo" data-v-1baff76c><ul class="breadcrumbs" data-v-1baff76c><li data-v-1baff76c><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1baff76c></a></li> <li data-v-1baff76c><a href="/categories/?category=%E7%BB%84%E4%BB%B6" title="分类" data-v-1baff76c>组件</a></li></ul> <div class="info" data-v-1baff76c><div title="作者" class="author iconfont icon-touxiang" data-v-1baff76c><a href="javascript:;" data-v-1baff76c>张畅</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1baff76c><a href="javascript:;" data-v-1baff76c>2023-02-03</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">ElasticSearch<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="elasticsearch"><a href="#elasticsearch" class="header-anchor">#</a> ElasticSearch</h1> <h2 id="_1、搜索引擎介绍"><a href="#_1、搜索引擎介绍" class="header-anchor">#</a> 1、搜索引擎介绍</h2> <blockquote><p>在互联网项目中，涉及到检索的业务需求很多，我们可以通过对数据库的模糊查询实现检索功能，但是针对
⼤数据量的操作，基于数据库的检索就显得力不从⼼了（查询效率很低）。所需我们要寻求⼀种⾼效的数据
检索解决⽅案</p></blockquote> <p><img alt="image-20220101110429637" data-src="https://s2.loli.net/2022/01/01/nXYOL9KCogFbZQt.png" loading="lazy" class="lazy"></p> <p>所谓搜索引擎，就是根据用户需求与⼀定算法，运用特定策略从互联网检索出指定的信息反馈给用户的⼀门检索技
术。搜索引擎依托于多种技术，如网络爬虫技术、检索排序技术、网页处理技术、大数据处理技术、自然语言处理
技术等，为信息检索用户提供快速、高相关性的信息服务。搜索引擎技术的核心模块⼀般包括爬虫、索引、检索和
排序等，同时可添加其他⼀系列辅助模块，以为用户创造更好的网络使用环境</p> <p>搜索方式：</p> <p>搜索方式是搜索引擎的⼀个关键环节，大致可分为四种： 全文搜索引擎、 元搜索引擎、 垂直搜索引擎和目录搜
索引擎，它们各有特点并适用于不同的搜索环境</p> <h2 id="_2、lucene简介"><a href="#_2、lucene简介" class="header-anchor">#</a> 2、Lucene简介</h2> <h3 id="_2-1、doug-cutting"><a href="#_2-1、doug-cutting" class="header-anchor">#</a> 2.1、Doug Cutting</h3> <p>1997年底， Cutting开始以每周两天的时间投⼊，在家里试着用Java把这个想法变成现实，不久之后， Lucene诞⽣
了。作为第⼀个提供全文文本搜索的开源函数库， Lucene的伟大自不必多言。</p> <h3 id="_2-2、lucene介绍"><a href="#_2-2、lucene介绍" class="header-anchor">#</a> 2.2、Lucene介绍</h3> <blockquote><p>Lucene是Apache Jakarta家族中的⼀个开源项目，是⼀个开放源代码的全⽂检索引擎⼯具包，但它不是⼀个
完整的 全文检索引擎，而是⼀个全⽂检索引擎的架构，提供了完整的查询引擎、索引引擎和部分⽂本分析引
擎。
Lucene提供了⼀个简单却强⼤的应⽤程式接⼝，能够做全⽂索引和搜寻。在Java开发环境⾥Lucene是⼀个成
熟的免费开源⼯具，是⽬前最为流⾏的基于 Java 开源全⽂检索⼯具包。</p></blockquote> <ul><li>数据总体分为两种：
<ul><li>结构化数据：指具有固定格式或有限长度的数据，如数据库、元数据等</li> <li>非结构化数据：指不定长或无固定格式的数据，如邮件、 word⽂档等磁盘上的⽂件</li></ul></li> <li>对于结构化数据的全⽂搜索很简单，因为数据都是有固定格式的，例如搜索数据库中数据使⽤SQL语句即可</li> <li>对于非结构化数据，有以下两种⽅法：
<ul><li>顺序扫描法(Serial Scanning)</li> <li>全文检索(Full-text Search)</li></ul></li></ul> <p>**顺序扫描法：**如果要找包含某⼀特定内容的⽂件，对于每⼀个⽂档，从头到尾扫描内容，如果此⽂档包含此字符
串， 则此⽂档为我们要找的⽂件，接着看下⼀个⽂件，直到扫描完所有的⽂件，因此速度很慢。</p> <p>**全文检索：**将⾮结构化数据中的⼀部分信息提取出来，重新组织，使其变得具有⼀定结构，然后对此有⼀定结构
的数 据进⾏搜索，从⽽达到搜索相对较快的⽬的。这部分从⾮结构化数据中提取出的然后重新组织的信息，我们
称之索引。</p> <h3 id="_2-3、lucene全文检索流程"><a href="#_2-3、lucene全文检索流程" class="header-anchor">#</a> 2.3、Lucene全文检索流程</h3> <p><img alt="image-20220101112231114" data-src="https://s2.loli.net/2022/01/01/O52nPX4sqxrBYSl.png" loading="lazy" class="lazy"></p> <ul><li>创建索引过程，对要搜索的原始内容进⾏索引构建⼀个索引库。索引过程包括：确定原始内容即要搜索的内
容→采集⽂档→创建⽂档→分析⽂档→索引⽂档。</li> <li>搜索索引过程，从索引库中搜索内容。搜索过程包括：⽤户通过搜索界⾯→创建查询→执⾏搜索，从索引库
搜索→ 渲染搜索结果。</li></ul> <p><img alt="image-20220101112305765" data-src="https://s2.loli.net/2022/01/01/DKdupneUJYHN1Wf.png" loading="lazy" class="lazy"></p> <h4 id="_2-3-1、创建索引"><a href="#_2-3-1、创建索引" class="header-anchor">#</a> 2.3.1、创建索引</h4> <p>对文档索引的过程，将⽤户要搜索的⽂档内容进⾏索引，索引存储在索引库（index）中。 这⾥我们要搜索的⽂档
是 磁盘上的⽂本⽂件，根据案例描述：凡是⽂件名或⽂件内容包括关键字的⽂件都要找出来，这⾥要对⽂件名和
⽂件内容创建索引。</p> <ul><li><p><strong>获得原始文档</strong></p> <p>原始⽂档是指要索引和搜索的内容。原始内容包括互联⽹上的⽹⻚、数据库中的数据、磁盘上的⽂件等。</p></li> <li><p><strong>创建⽂档对象</strong></p> <p>获取原始内容的⽬的是为了索引，在索引前需要将原始内容创建成⽂档（Document），⽂档中包括⼀个⼀个
的域 （Field），域中存储内容。 这⾥我们可以将磁盘上的⼀个⽂件当成⼀个document， Document中包括⼀
些 Field（file_name⽂件名称、 file_path⽂件路径、 file_size⽂件⼤⼩、 file_content⽂件内容），如下图：</p> <p><img alt="image-20220101112426123" data-src="https://s2.loli.net/2022/01/01/de4hDLCUOaTNzsZ.png" loading="lazy" class="lazy"></p> <p>注意：</p> <ul><li><p>每个Document可以有多个Field，不同的Document可以有不同的Field</p></li> <li><p>每个⽂档都有⼀个唯⼀的编号，就是⽂档id</p></li></ul></li> <li><p><strong>分析⽂档</strong></p> <p>将原始内容创建为包含域（Field）的⽂档（document），需要再对域中的内容进⾏分析，分析的过程是经过
对原始⽂档提取单词、将字⺟转为⼩写、去除标点符号、去除停⽤词等过程⽣成最终的语汇单元，可以将语
汇单元理解为⼀ 个⼀个的单词。 ⽐如下边的⽂档经过分析如下：</p> <p>原文档内容：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Lucene is a Java full-text search engine. Lucene is not a complete application, but rather
a code library and API that can easily be used to add search capabilities to applications.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>分析后得到的语汇单元：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>lucene、 java、 full、 search、 engine...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>每个单词叫做⼀个Term，不同的域中拆分出来的相同的单词是不同的term。 term中包含两部分⼀部分是⽂档
的域名，另⼀部分是单词的内容。 例如：⽂件名中包含apache和文件内容中包含的apache是不同的term。</p></li> <li><p><strong>创建索引—倒排索引</strong></p> <p>对所有⽂档分析得出的语汇单元进⾏索引，索引的⽬的是为了搜索，最终要实现只搜索被索引的语汇单元从
⽽找到 Document（⽂档）</p> <p><img alt="image-20220101112824876" data-src="https://s2.loli.net/2022/01/01/faC3onqie9j7GJh.png" loading="lazy" class="lazy"></p> <p>注意：创建索引是对语汇单元索引，通过词语找⽂档，这种索引的结构叫倒排索引结构。 传统⽅法是根据⽂
件找到 该⽂件的内容，在⽂件内容中匹配搜索关键字，这种⽅法是顺序扫描⽅法，数据量⼤、搜索慢。 倒排
索引结构是根 据内容（词语）找⽂档，如下图：</p> <p><img alt="image-20220101112908854" data-src="https://s2.loli.net/2022/01/01/ymHgT9SncuG6xr1.png" loading="lazy" class="lazy"></p> <p>倒排索引结构也叫反向索引结构，包括索引和⽂档两部分，索引即词汇表，它的规模较⼩，⽽⽂档集合较⼤。</p></li></ul> <h4 id="_2-3-2、查询索引"><a href="#_2-3-2、查询索引" class="header-anchor">#</a> 2.3.2、查询索引</h4> <p>查询索引也是搜索的过程。搜索就是⽤户输⼊关键字，从索引（index）中进⾏搜索的过程。根据关键字搜索索
引， 根据索引找到对应的⽂档，从⽽找到要搜索的内容（这⾥指磁盘上的⽂件）。</p> <ul><li><p>⽤户查询接⼝</p> <p>全⽂检索系统提供⽤户搜索的界⾯供⽤户提交搜索的关键字，搜索完成展示搜索结果。 Lucene不提供制作⽤
户搜索界⾯的功能，需要根据⾃⼰的需求开发搜索界⾯。</p></li> <li><p>创建查询</p> <p>⽤户输⼊查询关键字执⾏搜索之前需要先构建⼀个查询对象，查询对象中可以指定查询要搜索的Field⽂档
域、查询关键字等，查询对象会⽣成具体的查询语法，例如： 语法 “fileName:lucene”表示要搜索Field域的内
容为“lucene”的⽂档</p></li> <li><p>执⾏查询</p> <p>搜索索引过程： 根据查询语法在倒排索引词典表中分别找出对应搜索词的索引，从⽽找到索引所链接的⽂档
链表。 ⽐如搜索语法为“fileName:lucene”表示搜索出fileName域中包含Lucene的⽂档。 搜索过程就是在索引
上查找域为 fileName，并且关键字为Lucene的term，并根据term找到⽂档id列表。</p></li> <li><p>渲染查询结果</p> <p>以⼀个友好的界⾯将查询结果展示给⽤户，⽤户根据搜索结果找⾃⼰想要的信息，为了帮助⽤户很快找到⾃
⼰的结 果，提供了很多展示的效果，⽐如搜索结果中将关键字⾼亮显示，百度提供的快照等。</p></li></ul> <h3 id="_2-4、分词器"><a href="#_2-4、分词器" class="header-anchor">#</a> 2.4、分词器</h3> <h4 id="_2-4-1、分词器的作用"><a href="#_2-4-1、分词器的作用" class="header-anchor">#</a> 2.4.1、分词器的作用</h4> <p>a. 在创建索引的时候需要⽤到分词器，在使⽤字符串搜索的时候也会⽤到分词器，并且这两个地⽅要使⽤同⼀个
分词器，否则可能会搜索不出来结果。</p> <p>b. 分词器(Analyzer)的作⽤是把⼀段⽂本中的词按规则取出所包含的所有词，对应的是Analyzer类，这是⼀个抽 象
类(public abstract class org.apache.lucene.analysis.Analyzer)，切分词的具体规则是由⼦类实现的，所以对于不 同的
语⾔规则，要有不同的分词器。</p> <h4 id="_2-4-2、英文分词器的原理"><a href="#_2-4-2、英文分词器的原理" class="header-anchor">#</a> 2.4.2、英文分词器的原理</h4> <p>a.英⽂的处理流程为：输⼊⽂本，词汇切分，词汇过滤(去除停⽤词)，词⼲提取(形态还原)、⼤写转⼩写，结果输
出。</p> <p>b. 何为形态还原，意思是：去除单词词尾的形态变化，将其还原为词的原形，这样做可以搜索出更多有意义的结
果，⽐如在搜索student的时候，同事也可以搜索出students的结果。</p> <p>c. 任何⼀个分词法对英⽂的⽀持都是还可以的。</p> <h4 id="_2-4-3、中文分词器的原理"><a href="#_2-4-3、中文分词器的原理" class="header-anchor">#</a> 2.4.3、中文分词器的原理</h4> <p>中⽂分词⽐较复杂，并没有英⽂分词那么简单，这主要是因为中⽂的词与词之间并不是像英⽂那样⽤空格来隔
开，因为不是⼀个字就是⼀个词，⽽且⼀个词在另外⼀个地⽅就可能不是⼀个词，如： &quot;我们是中国⼈&quot;， &quot;是中&quot;就不是⼀ 个词，对于中⽂分词，通常有三种⽅式：单字分词、⼆分法分词、词典分词。</p> <ul><li>单字分词：就是按照中⽂⼀个字⼀个字的进⾏分词，⽐如:&quot;我们是中国⼈&quot;，分词的效果就是&quot;我&quot;， &quot;们&quot;， &quot;是&quot;， &quot;中&quot;， &quot;国&quot;， &quot;⼈&quot;， StandardAnalyzer分词法就是单字分词。</li> <li>⼆分法分词：按照两个字进⾏切分，⽐如： &quot;我们是中国⼈&quot;，分词的效果就是： &quot;我们&quot;， &quot;们是&quot;， &quot;是中&quot;， &quot;中国&quot;， &quot;国⼈&quot;， CJKAnalyzer分词法就是⼆分法分词</li> <li>词库分词：按照某种算法构造词，然后去匹配已建好的词库集合，如果匹配到就切分出来成为词语，通常词库分词被认为是最好的中⽂分词算法，如： &quot;我们是中国⼈&quot;，分词的效果就是:&quot;我们&quot;， &quot;中国⼈&quot;，极易分词MMAnalyzer、庖丁分词、 IkAnalyzer等分词法就是属于词库分词。</li></ul> <h4 id="_2-4-4、停用词的规"><a href="#_2-4-4、停用词的规" class="header-anchor">#</a> 2.4.4、停用词的规</h4> <p>有些词在⽂本中出现的频率⾮常⾼，但是对⽂本所携带的信息基本不产⽣影响，例如英⽂的&quot;a、 an、 the、 of&quot;或中⽂ 的&quot;的、了、着、是&quot;，以及各种标点符号等，这样的词称为停⽤词，⽂本经过分词处理后，停⽤词通常会被过滤掉， 不会被进⾏索引，在检索的时候，⽤户的查询中如果含有停⽤词，检索系统也会将其过滤掉，这是因为⽤户输⼊查询字符串也要进⾏分词处理，排除停⽤词可以提升建⽴索引的速度，减⼩索引库⽂件的⼤⼩。</p> <h4 id="_2-4-5、常用分词器"><a href="#_2-4-5、常用分词器" class="header-anchor">#</a> 2.4.5、常用分词器</h4> <ul><li><p>WhitespaceAnalyzer</p> <p>仅仅是去掉了空格，没有其他任何操作，不⽀持中⽂。</p></li> <li><p>SimpleAnalyzer</p> <p>将除了字⺟以外的符号全部去除，并且将所有字符变为⼩写，需要注意的是这个分词器同样把数据也去除
了，同样不⽀持中⽂。</p></li> <li><p>StopAnalyzer</p> <p>这个和SimpleAnalyzer类似，不过⽐他增加了⼀个的是，在其基础上还去除了所谓的stop words，⽐如the, a,
this这些。这个也是不⽀持中⽂的。</p></li> <li><p>StandardAnalyzer</p> <p>英⽂⽅⾯的处理和StopAnalyzer⼀样的，对中⽂⽀持，使⽤的是单字切割。</p></li> <li><p>CJKAnalyzer</p> <p>这个⽀持中⽇韩，前三个字⺟也就是这三个国家的缩写。这个对于中⽂基本上不怎么⽤吧，对中⽂的⽀持很
烂，它是 ⽤每两个字作为分割，分割⽅式个⼈感觉⽐较奇葩，我会在下⾯⽐较举例。</p></li> <li><p>SmartChineseAnalyzer</p> <p>中⽂的分词,⽐较标准的中⽂分词，对⼀些搜索处理的并不是很好。</p></li> <li><p>IKAnalyzer</p> <p>中国人自己开发，对于中文分词比较精准</p></li></ul> <h4 id="_2-4-6、ik-分词器"><a href="#_2-4-6、ik-分词器" class="header-anchor">#</a> 2.4.6、IK 分词器</h4> <p>Elasticsearch中⽂分词我们采⽤Ik分词， ik有两种分词模式： ik_max_word和ik_smart模式;</p> <p>ik_max_word 和 ik_smart 什么区别?</p> <ul><li>ik_max_word: 会将⽂本做最细粒度的拆分，⽐如会将“中华⼈⺠共和国国歌”拆分为“中华⼈⺠共和国,中华⼈
⺠, 中华,华⼈,⼈⺠共和国,⼈⺠,⼈,⺠,共和国,共和,和国,国歌”，会穷尽各种可能的组合；</li> <li>ik_smart: 会做最粗粒度的拆分，⽐如会将“中华⼈⺠共和国国歌”拆分为“中华⼈⺠,共和国,国歌”。 索引时，为
了提供索引的覆盖范围，通常会采⽤ik_max_word分析器，会以最细粒度分词索引，搜索时为了提⾼搜索准确
度，会采⽤ik_smart分析器，会以粗粒度分词</li></ul> <p>我们可以使⽤⽹上的⼀些⼯具查看分词的效果，比如https://www.sojson.com/analyzer</p> <h3 id="_2-5、lucene全文检索与数据库查询的比较"><a href="#_2-5、lucene全文检索与数据库查询的比较" class="header-anchor">#</a> 2.5、lucene全文检索与数据库查询的比较</h3> <h4 id="_2-5-1、性能上"><a href="#_2-5-1、性能上" class="header-anchor">#</a> 2.5.1、性能上</h4> <ul><li>数据库：⽐如我要查找某个商品，根据商品名，⽐如select * from product where doctname like %keywords%,这样查询的话对于数据量少是可以的，可是⼀旦你的数据量巨⼤⼏万⼏⼗万的时候，你的性能将会极⼤的减弱。</li> <li>lucene: 全⽂检索，建⽴⼀个索引库，⼀次建⽴多次使⽤。在索引库⾥⾯会把所有的商品名根据分词器建⽴索引，就好⽐新华字典，索引对应document，⽐如输⼊衬衫，那么就会根据索引迅速的翻到衬衫对应的商品名，时间迅速， 性能很好。</li></ul> <h4 id="_2-5-2、相关度排序"><a href="#_2-5-2、相关度排序" class="header-anchor">#</a> 2.5.2、相关度排序</h4> <ul><li>数据库：数据库要实现该功能也是可以的，可是需要改变表的结构，添加⼀个字段，然后该字段⽤于排名，最后查询 的时候order by ⼀下</li> <li>lucene: 查询出来的document都有⼀个算法（得分），根据算法可以计算得分，得分越⾼的排名越靠前，⽐如百度搜索⼀个东⻄，⼀般排名靠前的得分越⾼，得分通过算法，可以⼈⼯控制，⽐如百度推⼴，企业给的钱多得分⾃然⾼，因此排名靠前</li></ul> <h4 id="_2-5-3、准确性"><a href="#_2-5-3、准确性" class="header-anchor">#</a> 2.5.3、准确性</h4> <ul><li>数据库： select * from product where doctname like %ant%,搜索出来的可以是plant,aplant,planting等等，准确性不⾼</li> <li>lucene：通过索引查询的，就好像你查字典⼀样，准确性⽐数据库的模糊查询⾼许多</li></ul> <h2 id="_3、elasticsearch简介"><a href="#_3、elasticsearch简介" class="header-anchor">#</a> 3、ElasticSearch简介</h2> <h3 id="_3-1、elasticsearch-vs-lucene的关系"><a href="#_3-1、elasticsearch-vs-lucene的关系" class="header-anchor">#</a> 3.1、ElasticSearch vs Lucene的关系</h3> <p>ElasticSearch vs Lucene的关系，简单⼀句话就是，成品与半成品的关系。</p> <p>（1） Lucene专注于搜索底层的建设，⽽ElasticSearch专注于企业应⽤。</p> <p>（2） Luncene是单节点的API， ElasticSearch是分布式的—为集群⽽⽣。</p> <p>（3） Luncene需要⼆次开发，才能使⽤。不能像百度或⾕歌⼀样，它只是提供⼀个接⼝需要被实现才能使⽤,
ElasticSearch直接拿来⽤。</p> <h3 id="_3-2、elasticsearch与solr对比"><a href="#_3-2、elasticsearch与solr对比" class="header-anchor">#</a> 3.2、ElasticSearch与Solr对比</h3> <p>Solr与elasticsearch是当前两⼤最流⾏的搜索应⽤服务器，他们的底层都是基于lucene。</p> <ul><li>Elasticsearch是分布式的，不需要其他组件， Solr 利⽤ Zookeeper 进行分布式管理，而Elasticsearch ⾃身带 有
分布式协调管理功能</li> <li>Elasticsearch设计用于云计算中，处理多租户不需要特殊配置，而Solr则需要更多的⾼级设置。</li> <li>当单纯的对已有数据进⾏搜索时， Solr更快，实时建立索引时, Solr会产⽣io阻塞，查询性能较差, Elasticsearch
具有明显的优势，随着数据量的增加， Solr的搜索效率会变得更低，⽽Elasticsearch却没有明显的变化</li></ul> <p>Elasticsearch与Solr的性能测试比较:</p> <p>当单纯的对已有数据进行搜索时， Solr更快</p> <p><img alt="image-20220101113853579" data-src="https://s2.loli.net/2022/01/01/MEbvZ6ISkJ5tjBp.png" loading="lazy" class="lazy"></p> <h3 id="_3-3、elasticsearch特性"><a href="#_3-3、elasticsearch特性" class="header-anchor">#</a> 3.3、Elasticsearch特性</h3> <h4 id="_3-3-1、安装管理方便"><a href="#_3-3-1、安装管理方便" class="header-anchor">#</a> 3.3.1、安装管理⽅便</h4> <p>Elasticsearch没有其他依赖，下载后安装⾮常⽅便；只⽤修改⼏个参数就可以搭建起来⼀个集群。</p> <h4 id="_3-3-2、大规模分布式"><a href="#_3-3-2、大规模分布式" class="header-anchor">#</a> 3.3.2、大规模分布式</h4> <p>Elasticsearch允许你开始⼩规模使⽤，但是随着你使⽤数据的增⻓，它可以建⽴在横向扩展的开箱即⽤。当你需要
更多的容量，只需添加更多的节点，并让集群重组，只需要增加额外的硬件，让集群⾃动利⽤额外的硬件。</p> <p><code>可以在数以百计的服务器上处理PB级别的数据</code>。</p> <p>节点对外表现对等（每个节点都可以⽤来做⼊⼝）；加⼊节点⾃动均衡，可以扩展到上百台服务器，处理PB级别
的结构化或⾮结构化数据。</p> <p>Elasticsearch致⼒于隐藏分布式系统的复杂性。以下这些操作都是在底层⾃动完成的：</p> <ul><li>将你的⽂档分区到不同的容器或者分⽚(shards)中，它们可以存在于⼀个或多个节点中；</li> <li>将分⽚均匀的分配到各个节点，对索引和搜索做负载均衡；</li> <li>冗余每⼀个分⽚，防⽌硬件故障造成的数据丢失；</li> <li>将集群中任意⼀个节点上的请求路由到相应数据所在的节点；</li> <li>⽆论是增加节点，还是移除节点，分⽚都可以做到⽆缝的扩展和迁移</li></ul> <h4 id="_3-3-3、多租户支持"><a href="#_3-3-3、多租户支持" class="header-anchor">#</a> 3.3.3、多租户支持</h4> <p>ES处理多租户不需要特殊配置，可根据不同的⽤途分索引；可以同时操作多个索引。</p> <p>ES 的多租户简单的说就是通过多索引机制同时提供给多种业务使⽤，每种业务使⽤⼀个索引。我们可以把索引理
解 为关系型数据库⾥的库，那多索引可以理解为⼀个数据库系统建⽴多个库给不同的业务使⽤。</p> <p>在实际使⽤时，我们可以通过每个租户⼀个索引的⽅式将他们的数据进⾏隔离，并且每个索引是可以单独配置参数
的 （可对特定租户进⾏调优），这在典型的多租户场景下⾮常有⽤：例如我们的⼀个多租户应⽤需要提供搜索⽀
持，这 时可以通过 ES 根据租户建⽴索引，这样每个租户就可以在⾃⼰的索引下搜索相关内容了</p> <h4 id="_3-3-4、高可用性"><a href="#_3-3-4、高可用性" class="header-anchor">#</a> 3.3.4、高可用性</h4> <p>Elasticsearch集群是有弹性的 - 他们会⾃动检测到新的或失败的节点，以及重组和重新平衡数据，以确保数据安
全。</p> <h4 id="_3-3-5、操作持久化"><a href="#_3-3-5、操作持久化" class="header-anchor">#</a> 3.3.5、操作持久化</h4> <p>Elasticsearch把数据安全第⼀。⽂档改变被记录在群集上的多个节点上的事务⽇志(transaction logs)中记录，以减少
任何数据丢失的机会。</p> <h4 id="_3-3-6、友好的restful-api"><a href="#_3-3-6、友好的restful-api" class="header-anchor">#</a> 3.3.6、友好的RESTful API</h4> <p>Elasticsearch是API驱动。⼏乎任何动作都可以⽤⼀个简单的RESTful API使⽤JSON基于HTTP请求。 ElasticSearch 提
供多种语⾔的客户端 API。</p> <h3 id="_3-4、典型使用案例"><a href="#_3-4、典型使用案例" class="header-anchor">#</a> 3.4、典型使用案例</h3> <ul><li>维基百科使⽤Elasticsearch来进⾏全⽂搜做并⾼亮显示关键词，以及提供search-as-you-type、 did-you-mean 等
搜索建议功能。</li> <li>英国卫报使⽤Elasticsearch来处理访客⽇志，以便能将公众对不同⽂章的反应实时地反馈给各位编辑。</li> <li>StackOverflow将全⽂搜索与地理位置和相关信息进⾏结合，以提供more-like-this相关问题的展现。</li> <li>GitHub使⽤Elasticsearch来检索超过1300亿⾏代码。</li> <li>Goldman Sachs使⽤它来处理5TB数据的索引，还有很多投⾏使⽤它来分析股票市场的变动</li></ul> <h2 id="_4、elasticsearch逻辑结构"><a href="#_4、elasticsearch逻辑结构" class="header-anchor">#</a> 4、Elasticsearch逻辑结构</h2> <blockquote><p>集群--&gt;index(索引)--&gt;types(类型)--&gt;document(⽂档)--&gt;field(字段)</p></blockquote> <h3 id="_4-1、索引-index"><a href="#_4-1、索引-index" class="header-anchor">#</a> 4.1、索引（index）</h3> <p>索引是ElasticSearch存放数据的地⽅，可以理解为关系型数据库中的⼀个数据库。</p> <p>事实上，我们的数据被存储和索引 在分⽚(shards)中，索引只是⼀个把⼀个或多个分⽚分组在⼀起的逻辑空间。然
⽽，这只是⼀些内部细节——我们的 程序完全不⽤关⼼分⽚。对于我们的程序⽽⾔，⽂档存储在索引(index)中。剩
下的细节由Elasticsearch关⼼既可。</p> <p><code>索引的名字必须是全部⼩写，不能以下划线开头，不能包含逗号</code></p> <h3 id="_4-2、类型-type"><a href="#_4-2、类型-type" class="header-anchor">#</a> 4.2、类型（type）</h3> <p>类型⽤于区分同⼀个索引下不同的数据类型,相当于关系型数据库中的表。在Elasticsearch中，我们使⽤相同类型
(type)的⽂档表示相同的“事物”，因为他们的数据结构也是相同的。每个类型(type)都有⾃⼰的映射(mapping)或者
结 构定义，就像传统数据库表中的列⼀样。所有类型下的⽂档被存储在同⼀个索引下，但是类型的映射(mapping)
会告 诉Elasticsearch不同的⽂档如何被索引。</p> <p><code>es 6.0 开始不推荐⼀个index下多个type的模式，并且会在 7.0 中完全移除。在7.0 的index下是⽆法创建多个type</code></p> <h3 id="_4-3、文档-documents"><a href="#_4-3、文档-documents" class="header-anchor">#</a> 4.3、文档（documents）</h3> <p>⽂档是ElasticSearch中存储的实体，类⽐关系型数据库，每个⽂档相当于数据库表中的⼀⾏数据。 在Elasticsearch
中，⽂档(document)这个术语有着特殊含义。它特指最顶层结构或者根对象(root object)序列化成的JSON数据（以
唯⼀ID标识并存储于Elasticsearch中）。</p> <h3 id="_4-4、字段-fields"><a href="#_4-4、字段-fields" class="header-anchor">#</a> 4.4、字段（fields）</h3> <p>⽂档由字段组成，相当于关系数据库中列的属性，不同的是ES的不同⽂档可以具有不同的字段集合。</p> <h3 id="_4-5、节点与集群"><a href="#_4-5、节点与集群" class="header-anchor">#</a> 4.5、节点与集群</h3> <p>⼀个集群是由⼀个或多个节点组成的集合，集群上的节点将会存储数据，并提供跨节点的索引和搜索功能。
集群通过⼀个唯⼀的名称作为标识，节点通过设置集群名称就可以加⼊相应的集群，当然这需要节点所在的⽹络能
够发现集群。所以要注意在同⼀个⽹络中，不同环境、服务的集群的名称不能重复。</p> <p>⼀个节点就是⼀个 Elasticsearch 服务 （实例），可以实现存储数据，索引并且搜索的功能。和集群⼀样，每个节
点都有⼀个唯⼀的名称作为身份标识，如果没有设置名称，默认使⽤ UUID 作为名称。如果想更好的管理集群，最
好给每个节点都定义上有意义的名称，在集群中区分出各个节点。节点通过设置集群名称，在同⼀⽹络中发现具有
相同集群名称的节点，组成集群。默认的集群名称为 elasticsearch 。</p> <p>如果在同⼀⽹络中只有⼀个节点，则这个节点成为⼀个单节点集群，换句话说就是每个节点都是功能⻬全的服务。</p> <h2 id="_5、elasticsearch安装"><a href="#_5、elasticsearch安装" class="header-anchor">#</a> 5、Elasticsearch安装</h2> <h3 id="_5-1、elastic-和-elasticsearch"><a href="#_5-1、elastic-和-elasticsearch" class="header-anchor">#</a> 5.1、Elastic 和 Elasticsearch</h3> <p>Elastic官⽹： https://www.elastic.co/cn/
Elastic有⼀条完整的产品线及解决⽅案： Elasticsearch、 Logstash、 Kibana等，这三个就是⼤家常说的ELK技术栈。</p> <p><img alt="image-20220101161024646" data-src="https://s2.loli.net/2022/01/01/r2gxXQ1nMfkUq9j.png" loading="lazy" class="lazy"></p> <p>Elasticsearch官⽹： https://www.elastic.co/cn/products/elasticsearch</p> <h3 id="_5-2、linux下安装es"><a href="#_5-2、linux下安装es" class="header-anchor">#</a> 5.2、Linux下安装ES</h3> <blockquote><p>出于安全考虑， elasticsearch默认不允许以root账号运⾏</p></blockquote> <ul><li><p>创建⽤户设置密码</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># useradd es</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># passwd es</span>
Changing password <span class="token keyword">for</span> user es.
New password: 6610root
Retype new password:
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># chmod 777 /usr/local 【授予es⽤户/usr/local⽬录 可读可写可执⾏权限】</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># su - es</span>
<span class="token punctuation">[</span>es@localhost ~<span class="token punctuation">]</span>$
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>检查JDK版本(需要JDK1.8+)</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>es@localhost ~<span class="token punctuation">]</span><span class="token comment"># java -version</span>
openjdk version <span class="token string">&quot;1.8.0_222-ea&quot;</span>
OpenJDK Runtime Environment <span class="token punctuation">(</span>build <span class="token number">1.8</span>.0_222-ea-b03<span class="token punctuation">)</span>ll
OpenJDK <span class="token number">64</span>-Bit Server VM <span class="token punctuation">(</span>build <span class="token number">25.222</span>-b03, mixed mode<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>将ES的压缩包上传⾄ /usr/local ⽬录并解压</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>es@localhost local<span class="token punctuation">]</span>$ <span class="token function">tar</span> -zxvf elasticsearch-7.6.1-linux-x86_64.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>查看配置文件</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>es@localhost local<span class="token punctuation">]</span><span class="token comment"># cd elasticsearch-7.6.1/config/</span>
<span class="token punctuation">[</span>es@localhost config<span class="token punctuation">]</span><span class="token comment"># ls</span>
elasticsearch.yml jvm.options log4j2.properties role_mapping.yml roles.yml <span class="token function">users</span>
users_roles
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>修改jvm.options</p> <p>Elasticsearch基于Lucene的，⽽Lucene底层是java实现，因此我们需要配置jvm参数</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>es@localhost config<span class="token punctuation">]</span><span class="token comment"># vim jvm.options</span>
<span class="token comment"># 默认配置如下</span>
<span class="token comment"># Xms represents the initial size of total heap space</span>
<span class="token comment"># Xmx represents the maximum size of total heap space</span>
-Xms1g
-Xmx1g
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>修改 elasticsearch.yml</p> <ul><li>修改集群节点信息</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># ---------------------------------- Cluster -----------------------------------17</span>
cluster.name: my-application
<span class="token comment"># ------------------------------------ Node ------------------------------------23</span>
node.name: node-1
<span class="token comment"># --------------------------------- Discovery ----------------------------------72</span>
cluster.initial_master_nodes: <span class="token punctuation">[</span><span class="token string">&quot;node-1&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>修改数据⽂件和⽇志⽂件存储⽬录路径（如果⽬录不存在则需创建）</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@localhost config<span class="token punctuation">]</span><span class="token comment"># vim elasticsearch.yml</span>
<span class="token comment"># ---------------------------- Paths ------------------------------</span>
path.data: /usr/local/elasticsearch-7.6.1/data
path.logs: /usr/local/elasticsearch-7.6.1/logs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>修改绑定的ip，默认只允许本机访问，修改为0.0.0.0后则可以远程访问</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># ---------------------------- Network ------------------------------</span>
<span class="token comment"># 默认只允许本机访问，修改为0.0.0.0后则可以远程访问</span>
network.host: <span class="token number">0.0</span>.0.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><p>配置信息说明</p> <p>⽬前我们是做的单机安装，如果要做集群，只需要在这个配置⽂件中添加其它节点信息即可。</p></li></ul></li></ul> <p>​		<img alt="image-20220101161558931" data-src="https://s2.loli.net/2022/01/01/VFyiHS3pkfwlDOQ.png" loading="lazy" class="lazy"></p> <ul><li><p>进⼊elasticsearch/bin⽬录运⾏</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>es@localhost elasticsearch-7.6.1<span class="token punctuation">]</span><span class="token comment"># cd /usr/local/elasticsearch-7.6.1/bin</span>
<span class="token punctuation">[</span>es@localhost elasticsearch-7.6.1<span class="token punctuation">]</span><span class="token comment"># ./elasticsearch</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>* soft nofile <span class="token number">666666666</span>
* hard nofile <span class="token number">131072</span>
* soft nproc <span class="token number">4096</span>
* hard nproc <span class="token number">4096</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul> <h3 id="_5-3、启动错误问题总结"><a href="#_5-3、启动错误问题总结" class="header-anchor">#</a> 5.3、启动错误问题总结</h3> <h4 id="_5-3-1、错误1-内核过低"><a href="#_5-3-1、错误1-内核过低" class="header-anchor">#</a> 5.3.1、错误1：内核过低</h4> <p><img alt="image-20220101161742315" data-src="https://s2.loli.net/2022/01/01/SeCpdN4IYD6tghu.png" loading="lazy" class="lazy"></p> <p>我们使⽤的是centos6，其linux内核版本为2.6。⽽Elasticsearch的插件要求⾄少3.5以上版本。不过没关系，我们禁
⽤这个插件即可。</p> <p>修改elasticsearch.yml⽂件，在最下⾯添加如下配置：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>bootstrap.system_call_filter: <span class="token boolean">false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后重启</p> <h4 id="_5-3-2、错误2-文件权限不足"><a href="#_5-3-2、错误2-文件权限不足" class="header-anchor">#</a> 5.3.2、错误2：文件权限不足</h4> <p><img alt="image-20220101161902760" data-src="https://s2.loli.net/2022/01/01/ZLvF9Mz847AaG1k.png" loading="lazy" class="lazy"></p> <p>我们⽤的是es⽤户，⽽不是root，所以⽂件权限不⾜。</p> <p>⾸先⽤root⽤户登录,然后修改配置⽂件:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">vim</span> /etc/security/limits.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>添加下⾯的内容：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>* soft nofile <span class="token number">65536</span>
* hard nofile <span class="token number">131072</span>
* soft nproc <span class="token number">4096</span>
* hard nproc <span class="token number">4096</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_5-3-3、错误3-线程数不够"><a href="#_5-3-3、错误3-线程数不够" class="header-anchor">#</a> 5.3.3、错误3：线程数不够</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>[1]: max number of threads [1024] for user [es] is too low, increase to at least [4096]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这是线程数不够</p> <p>继续修改配置</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">vim</span> /etc/security/limits.d/20-nproc.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>修改下面的内容</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>soft nproc <span class="token number">1024</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>改为</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>soft nproc <span class="token number">4096</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_5-3-4、错误4-进程虚拟内存"><a href="#_5-3-4、错误4-进程虚拟内存" class="header-anchor">#</a> 5.3.4、错误4：进程虚拟内存</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>: max virtual memory areas vm.max_map_count <span class="token punctuation">[</span><span class="token number">65530</span><span class="token punctuation">]</span> likely too low, increase to at least
<span class="token punctuation">[</span><span class="token number">262144</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>vm.max_map_count：限制⼀个进程可以拥有的VMA(虚拟内存区域)的数量</p> <p>继续修改配置⽂件， vim /etc/sysctl.conf 添加下⾯内容：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>vm.max_map_count<span class="token operator">=</span><span class="token number">655360</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>修改完成之后在终端执行</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">##然后执⾏命令</span>
sysctl -p
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_5-3-5、错误5-未设置节点"><a href="#_5-3-5、错误5-未设置节点" class="header-anchor">#</a> 5.3.5、错误5：未设置节点</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>the default discovery settings are unsuitable <span class="token keyword">for</span> production use<span class="token punctuation">;</span> at least one of
<span class="token punctuation">[</span>discovery.seed_ho<span class="token punctuation">..</span>.<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>修改elasticsearch.yml</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>cluster.name: my-application
node.name: node-1
cluster.initial_master_nodes: <span class="token punctuation">[</span><span class="token string">&quot;node-1&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_6、安装kibana"><a href="#_6、安装kibana" class="header-anchor">#</a> 6、安装Kibana</h2> <p>Kibana是⼀个基于Node.js的Elasticsearch索引库数据统计⼯具，可以利⽤Elasticsearch的聚合功能，⽣成各种图
表，如柱形图，线状图，饼图等。</p> <p>⽽且还提供了操作Elasticsearch索引数据的控制台，并且提供了⼀定的API提示，⾮常有利于我们学习Elasticsearch
的语法。</p> <p><img alt="image-20220101162440638" data-src="https://s2.loli.net/2022/01/01/LDxBcWXdpYAHNEu.png" loading="lazy" class="lazy"></p> <h3 id="_6-1、安装"><a href="#_6-1、安装" class="header-anchor">#</a> 6.1、安装</h3> <ul><li>kibana版本与elasticsearch保持⼀致，也是7.6.1解压到特定⽬录即可</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">tar</span> -zxvf kibana-7.6.1-linux-x86_64.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_6-2、配置"><a href="#_6-2、配置" class="header-anchor">#</a> 6.2、配置</h3> <ul><li>进⼊安装⽬录下的config⽬录，修改kibana.yml⽂件：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>server.port: <span class="token number">5601</span>
server.host: <span class="token string">&quot;0.0.0.0&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_6-3、运行"><a href="#_6-3、运行" class="header-anchor">#</a> 6.3、运行</h3> <p>进⼊安装⽬录下的bin⽬录启动：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>./kibana
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>发现kibana的监听端⼝是5601</p> <p>我们访问： http://8.130.18.255:5601</p> <h3 id="_6-4、控制台"><a href="#_6-4、控制台" class="header-anchor">#</a> 6.4、控制台</h3> <p><img alt="image-20220101162647982" data-src="https://s2.loli.net/2022/01/01/hsxSoHRiElbzNM5.png" loading="lazy" class="lazy"></p> <h2 id="_7、安装ik分词器"><a href="#_7、安装ik分词器" class="header-anchor">#</a> 7、安装IK分词器</h2> <h3 id="_7-1、安装ik分词器"><a href="#_7-1、安装ik分词器" class="header-anchor">#</a> 7.1、安装ik分词器</h3> <p><img alt="image-20220101162747123" data-src="https://s2.loli.net/2022/01/01/TfWL9kqFoH7UidI.png" loading="lazy" class="lazy"></p> <p>分词器配置完成以后，重启es</p> <h3 id="_7-2、测试分词器"><a href="#_7-2、测试分词器" class="header-anchor">#</a> 7.2、测试分词器</h3> <p><img alt="image-20220101162809783" data-src="https://s2.loli.net/2022/01/01/MiHA4IsPt7EhRov.png" loading="lazy" class="lazy"></p> <h3 id="_7-3、配置自定义词库"><a href="#_7-3、配置自定义词库" class="header-anchor">#</a> 7.3、配置⾃定义词库</h3> <ul><li>在elasticsearch-analysis-ik-7.6.1/plugins/ik/config⽬录中定义词典⽂件（.dic）</li> <li>在词典⽂件中定义⾃定义词汇</li> <li>elasticsearch-analysis-ik-7.6.1/plugins/ik/config/IKAnalyzer.cfg.xml加载⾃定义词典⽂件</li></ul> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">properties</span> <span class="token name">SYSTEM</span> <span class="token string">&quot;http://java.sun.com/dtd/properties.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>comment</span><span class="token punctuation">&gt;</span></span>IK Analyzer 扩展配置<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>comment</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--⽤户可以在这⾥配置⾃⼰的扩展字典 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ext_dict<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>mywords.dic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--⽤户可以在这⾥配置⾃⼰的扩展停⽌词字典--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ext_stopwords<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--⽤户可以在这⾥配置远程扩展字典 --&gt;</span>
<span class="token comment">&lt;!-- &lt;entry key=&quot;remote_ext_dict&quot;&gt;words_location&lt;/entry&gt; --&gt;</span>
<span class="token comment">&lt;!--⽤户可以在这⾥配置远程扩展停⽌词字典--&gt;</span>
<span class="token comment">&lt;!-- &lt;entry key=&quot;remote_ext_stopwords&quot;&gt;words_location&lt;/entry&gt; --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_8、es基本操作"><a href="#_8、es基本操作" class="header-anchor">#</a> 8、ES基本操作</h2> <h3 id="_8-1、es是基于restful实现访问"><a href="#_8-1、es是基于restful实现访问" class="header-anchor">#</a> 8.1、ES是基于RESTful实现访问</h3> <p>ES是⽀持web访问的，但必须遵从RESTful访问规范</p> <p><strong>ES逻辑结构</strong></p> <ul><li>数据库：数据是存储在数据表中的，数据表是创建在数据库中的</li> <li>ES： document是存储在type中的， type是创建在index中
<ul><li>index 索引 --- 相当于数据库 （索引的命名不能包含特殊字符，必须⼩写）</li> <li>type类型 --- 相当于数据表 （在es7以前，⼀个index中可以创建多个type ）</li> <li>document⽂档 --- 相当于数据表中的⼀条记录</li></ul></li></ul> <p><strong>RESTful</strong></p> <ul><li>不同操作需要使⽤不同的请求⽅式</li> <li>基于REST的基本访问规范</li></ul> <table><thead><tr><th>请求方式</th> <th>REST请求</th> <th>功能描述</th></tr></thead> <tbody><tr><td>PUT</td> <td>http://eshost:9200/index1</td> <td>创建index(索引)</td></tr> <tr><td>POST</td> <td>http://eshost:9200/索引名/类型名/⽂档ID</td> <td>添加document</td></tr> <tr><td>POST</td> <td>http://eshost:9200/索引名/类型名/⽂档ID/_update</td> <td>修改document⽂档</td></tr> <tr><td>DELETE</td> <td>http://eshost:9200/索引名/类型名/⽂档ID</td> <td>根据ID删除document</td></tr> <tr><td>GET</td> <td>http://eshost:9200/索引名/类型名/⽂档ID</td> <td>根据ID查询document</td></tr> <tr><td>POST</td> <td>http://eshost:9200/索引名/类型名/_search</td> <td>查询索引下所有数据</td></tr></tbody></table> <h3 id="_8-2、基本操作"><a href="#_8-2、基本操作" class="header-anchor">#</a> 8.2、基本操作</h3> <ul><li><p>创建索引</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment"># 【基本操作】</span>
<span class="token comment"># 1.创建索引 PUT</span>
<span class="token attr-name">PUT</span> <span class="token attr-value">index1</span>
<span class="token attr-name">PUT</span> <span class="token attr-value">index3</span>
{
<span class="token attr-name">  &quot;mappings&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;properties&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">      &quot;book_id&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">        &quot;type&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;long&quot;</span>
      },
<span class="token attr-name">      &quot;book_name&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">         &quot;type&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;text&quot;</span>
      },
<span class="token attr-name">      &quot;book_author&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">         &quot;type&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;keyword&quot;</span>
      },
<span class="token attr-name">      &quot;book_price&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">         &quot;type&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;float&quot;</span>
      },
<span class="token attr-name">      &quot;book_desc&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">         &quot;type&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;text&quot;</span>
      }
    }
  }
}
<span class="token comment"># 索引是⼀个逻辑单元， ES中的数据实际上是存储在分⽚中的,我们可以在settings中设置索引的属性</span>
<span class="token attr-name">PUT</span> <span class="token attr-value">index2</span>
{
<span class="token attr-name">  &quot;settings&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;number_of_shards&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">2</span>
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div></li> <li><p>查询索引</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment"># 查询索引信息</span>
<span class="token attr-name">GET</span> <span class="token attr-value">index1</span>
<span class="token comment"># 查询索引的mappings信息</span>
<span class="token attr-name">GET</span> <span class="token attr-value">index1/_mappings</span>
<span class="token comment"># 查询索引的属性设置</span>
<span class="token attr-name">GET</span> <span class="token attr-value">index1/_settings</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>创建⽂档：新增⼀条记录到ES</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">POST</span> <span class="token attr-value">index3/_doc/101</span>
{
<span class="token attr-name">  &quot;book_id&quot;</span><span class="token punctuation">:</span><span class="token attr-value">101,</span>
<span class="token attr-name">  &quot;book_name&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;Java程序设计&quot;,</span>
<span class="token attr-name">  &quot;book_author&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;千锋亮哥&quot;,</span>
<span class="token attr-name">  &quot;book_price&quot;</span><span class="token punctuation">:</span><span class="token attr-value">22.22,</span>
<span class="token attr-name">  &quot;book_desc&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;这是⼀本看了就会的Java秘籍&quot;</span>
}
<span class="token attr-name">POST</span> <span class="token attr-value">index3/_doc/102</span>
{
<span class="token attr-name">  &quot;book_id&quot;</span><span class="token punctuation">:</span><span class="token attr-value">102,</span>
<span class="token attr-name">  &quot;book_name&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;C++程序设计&quot;,</span>
<span class="token attr-name">  &quot;book_author&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;谭浩强&quot;,</span>
<span class="token attr-name">  &quot;book_price&quot;</span><span class="token punctuation">:</span><span class="token attr-value">22.22,</span>
<span class="token attr-name">  &quot;book_desc&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;C++程序设计中的名著&quot;</span>
}
<span class="token attr-name">POST</span> <span class="token attr-value">index3/_doc/103</span>
{
<span class="token attr-name">  &quot;book_id&quot;</span><span class="token punctuation">:</span><span class="token attr-value">103,</span>
<span class="token attr-name">  &quot;book_name&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;Python王者归来&quot;,</span>
<span class="token attr-name">  &quot;book_author&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;杰哥&quot;,</span>
<span class="token attr-name">  &quot;book_price&quot;</span><span class="token punctuation">:</span><span class="token attr-value">33.22,</span>
<span class="token attr-name">  &quot;book_desc&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;Python从⼊⻔到放弃&quot;</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>注意： 在ES 7.0版本以后，⼀个index中只能存在⼀个type(默认名称为_doc)</p></li> <li><p>修改⽂档：修改记录</p> <ul><li>使⽤新增操作的请求覆盖原记录</li></ul> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">POST</span> <span class="token attr-value">index3/_doc/103</span>
{
<span class="token attr-name">  &quot;book_id&quot;</span><span class="token punctuation">:</span><span class="token attr-value">103,</span>
<span class="token attr-name">  &quot;book_name&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;Python王者归来&quot;,</span>
<span class="token attr-name">  &quot;book_author&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;杰哥&quot;,</span>
<span class="token attr-name">  &quot;book_price&quot;</span><span class="token punctuation">:</span><span class="token attr-value">33.22,</span>
<span class="token attr-name">  &quot;book_desc&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;Python从⼊⻔到放弃&quot;</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>使⽤_update修改</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST index3/_doc/103/_update
{
  &quot;book_id&quot;:103,
  &quot;book_name&quot;:&quot;Python王者归来&quot;,
  &quot;book_author&quot;:&quot;杰哥&quot;,
  &quot;book_price&quot;:33.22,
  &quot;book_desc&quot;:&quot;Python从⼊⻔到放弃&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>查询⽂档</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment">#根据⽂档id查询数据</span>
<span class="token attr-name">GET</span> <span class="token attr-value">index3/_doc/101</span>
<span class="token comment">#查询索引中的所有数据（type使⽤⾃定名称）</span>
<span class="token attr-name">POST</span> <span class="token attr-value">index3/_doc/_search</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>删除⽂档</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">DELETE</span> <span class="token attr-value">index3/_doc/103</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>查看es状态_cat</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">_cat/indices?v</span>
<span class="token attr-name">GET</span> <span class="token attr-value">_cat/health?v</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <h3 id="_8-3、数据类型"><a href="#_8-3、数据类型" class="header-anchor">#</a> 8.3、数据类型</h3> <blockquote><p>es中⼀个document表示⼀条记录，记录中field值的存储是有类型的</p></blockquote> <p>https://www.elastic.co/guide/en/elasticsearch/reference/6.5/mapping-types.html</p> <p><strong>string</strong></p> <ul><li>text 可分词</li> <li>keyword 不能分词</li></ul> <p><strong>Numeric datatypes</strong></p> <p><code>long , integer , short , byte , double , float , half_float , scaled_float</code></p> <p><strong>Date datatype</strong></p> <ul><li>data --- ⽇期的存储时以 long 类型存储的毫秒数</li></ul> <p><strong>Boolean datatype</strong></p> <ul><li>boolean --- true | false | &quot;true&quot; | &quot;false&quot;</li></ul> <p><strong>Binary datatype</strong></p> <ul><li>binary 基于base64编码的字符串</li></ul> <p><strong>Range datatypes</strong></p> <p><code>integer_range , float_range , long_range , double_range , date_range</code></p> <p><strong>创建Index并指定field类型</strong></p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">PUT</span> <span class="token attr-value">index3</span>
{
<span class="token attr-name">  &quot;mappings&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;properties&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">      &quot;bookId&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">        &quot;type&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;long&quot;</span>
      },
<span class="token attr-name">      &quot;bookName&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">        &quot;type&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;text&quot;</span>
      },
<span class="token attr-name">      &quot;author&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">        &quot;type&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;keyword&quot;</span>
      },
<span class="token attr-name">      &quot;time&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">        &quot;type&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;date&quot;</span>
      }
    }
  }
}
<span class="token attr-name">GET</span> <span class="token attr-value">index3/_doc/_search</span>
<span class="token attr-name">POST</span> <span class="token attr-value">index3/_doc/1</span>
{
<span class="token attr-name">  &quot;bookId&quot;</span><span class="token punctuation">:</span><span class="token attr-value">10001,</span>
<span class="token attr-name">  &quot;bookName&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;Java程序设计&quot;,</span>
<span class="token attr-name">  &quot;author&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;张三&quot;,</span>
<span class="token attr-name">  &quot;time&quot;</span><span class="token punctuation">:</span><span class="token attr-value">234567890</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="_8-4、复杂查询-数据搜索"><a href="#_8-4、复杂查询-数据搜索" class="header-anchor">#</a> 8.4、复杂查询-数据搜索</h3> <h5 id="_8-4-1、数据准备"><a href="#_8-4-1、数据准备" class="header-anchor">#</a> 8.4.1、数据准备</h5> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">PUT</span> <span class="token attr-value">index4</span>
{
<span class="token attr-name">  &quot;mappings&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;properties&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">      &quot;bookId&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">        &quot;type&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;long&quot;</span>
      },
<span class="token attr-name">      &quot;bookName&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">        &quot;type&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;text&quot;</span>
      },
<span class="token attr-name">      &quot;author&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">        &quot;type&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;keyword&quot;</span>
      },
<span class="token attr-name">      &quot;time&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">        &quot;type&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;date&quot;</span>
      }
    }
  }
}
<span class="token attr-name">POST</span> <span class="token attr-value">index4/_doc/1</span>
{
<span class="token attr-name">  &quot;bookId&quot;</span><span class="token punctuation">:</span><span class="token attr-value">10001,</span>
<span class="token attr-name">  &quot;bookName&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;Java程序设计&quot;,</span>
<span class="token attr-name">  &quot;author&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;张三&quot;,</span>
<span class="token attr-name">  &quot;time&quot;</span><span class="token punctuation">:</span><span class="token attr-value">234567890</span>
}
<span class="token attr-name">POST</span> <span class="token attr-value">index4/_doc/2</span>
{
<span class="token attr-name">  &quot;bookId&quot;</span><span class="token punctuation">:</span><span class="token attr-value">10002,</span>
<span class="token attr-name">  &quot;bookName&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;C语⾔程序设计&quot;,</span>
<span class="token attr-name">  &quot;author&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;Java谭浩强&quot;,</span>
<span class="token attr-name">  &quot;time&quot;</span><span class="token punctuation">:</span><span class="token attr-value">2345678999</span>
}
<span class="token attr-name">POST</span> <span class="token attr-value">index4/_doc/3</span>
{
<span class="token attr-name">  &quot;bookId&quot;</span><span class="token punctuation">:</span><span class="token attr-value">10003,</span>
<span class="token attr-name">  &quot;bookName&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;程序设计进阶&quot;,</span>
<span class="token attr-name">  &quot;author&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;李三&quot;,</span>
<span class="token attr-name">  &quot;time&quot;</span><span class="token punctuation">:</span><span class="token attr-value">2345678222</span>
}
<span class="token attr-name">POST</span> <span class="token attr-value">index4/_doc/4</span>
{
<span class="token attr-name">  &quot;bookId&quot;</span><span class="token punctuation">:</span><span class="token attr-value">10004,</span>
<span class="token attr-name">  &quot;bookName&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;Java编程思想&quot;,</span>
<span class="token attr-name">  &quot;author&quot;</span><span class="token punctuation">:</span><span class="token attr-value">&quot;三⽑&quot;,</span>
<span class="token attr-name">  &quot;time&quot;</span><span class="token punctuation">:</span><span class="token attr-value">23456783452</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><h5 id="_8-4-2、复杂查询语法"><a href="#_8-4-2、复杂查询语法" class="header-anchor">#</a> 8.4.2、复杂查询语法</h5> <p><img alt="image-20220101164515364" data-src="https://s2.loli.net/2022/01/01/cXCzfa5ohN18Rtv.png" loading="lazy" class="lazy"></p> <h5 id="_8-4-3、term和terms"><a href="#_8-4-3、term和terms" class="header-anchor">#</a> 8.4.3、term和terms</h5> <blockquote><p>⽤于对keyword字段进⾏精确匹配</p></blockquote> <ul><li><p>term 表示完全匹配，搜索之前不会对关键字进⾏分词</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index3/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;term&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">      &quot;author&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;涛哥&quot;</span>
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>terms 也表示完全匹配，可以为⼀个field指定多个匹配关键词</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index3/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;terms&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">      &quot;author&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">[&quot;涛哥&quot;,&quot;李三&quot;]</span>
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ul> <h5 id="_8-4-4、match查询-重点"><a href="#_8-4-4、match查询-重点" class="header-anchor">#</a> 8.4.4、match查询（重点）</h5> <blockquote><p>match查询表示对text字段进⾏部分匹配（模糊查询）</p></blockquote> <ul><li><p><code>match 表示部分匹配，搜索之前会对关键词进⾏分词</code></p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index4/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;match&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">      &quot;bookName&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;Java程序&quot;</span>
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>match_all 表示查询全部内容，不指定任何条件</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index4/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;match_all&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{}</span>
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p><code>multi_match 在多个字段中匹配同⼀个关键字</code></p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index4/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;multi_match&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">      &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;Java&quot;,</span>
<span class="token attr-name">      &quot;fields&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">[&quot;bookName&quot;,&quot;author&quot;]</span>
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul> <h5 id="_8-4-5、根据id查询"><a href="#_8-4-5、根据id查询" class="header-anchor">#</a> 8.4.5、根据id查询</h5> <ul><li><p>根据⼀个id查询⼀个document</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index4/_doc/1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>根据多个id查询多个document ==&gt; select * from ... where id in [1,2,3]</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index4/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">    &quot;ids&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">      &quot;values&quot;</span><span class="token punctuation">:</span><span class="token attr-value">[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;]</span>
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ul> <h5 id="_8-4-6、其他查询"><a href="#_8-4-6、其他查询" class="header-anchor">#</a> 8.4.6、其他查询</h5> <ul><li><p>prefix查询，根据指定字段的前缀值进⾏查询</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index4/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;prefix&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">      &quot;author&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">        &quot;value&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;张&quot;</span>
      }
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>fuzzy查询，模糊查询，输⼊⼤概的内容es检索相关的数据</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index4/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;fuzzy&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">      &quot;bookName&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">        &quot;value&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;jav&quot;</span>
      }
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>wildcard查询：正则匹配</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index4/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;wildcard&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">      &quot;author&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">        &quot;value&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;张*&quot;</span>
      }
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>range查询，根据范围进⾏查询</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index4/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;range&quot;</span> <span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">      &quot;bookId&quot;</span> <span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">        &quot;gt&quot;</span> <span class="token punctuation">:</span> <span class="token attr-value">10001,</span>
<span class="token attr-name">        &quot;lte&quot;</span> <span class="token punctuation">:</span> <span class="token attr-value">10003</span>
      }
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>分⻚查询</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index4/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;match_all&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{}</span>
  },
<span class="token attr-name">  &quot;_source&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">[&quot;bookId&quot;,&quot;bookName&quot;],</span>
<span class="token attr-name">  &quot;from&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">0,</span>
<span class="token attr-name">  &quot;size&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">20</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul> <h4 id="_8-5、复合查询-bool"><a href="#_8-5、复合查询-bool" class="header-anchor">#</a> 8.5、复合查询—bool</h4> <blockquote><p>复合查询——多条件查询
should ==&gt; or
must ==&gt; and
must_not ==&gt; not</p></blockquote> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index4/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;bool&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">      &quot;must_not&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">[</span>
        {
<span class="token attr-name">          &quot;match&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">            &quot;bookName&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;Java&quot;</span>
          }
        },
        {
<span class="token attr-name">          &quot;match&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">            &quot;author&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;张三&quot;</span>
          }
        }
      ]
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="_8-6、结果过滤-filter"><a href="#_8-6、结果过滤-filter" class="header-anchor">#</a> 8.6、结果过滤—filter</h4> <blockquote><p>filter——根据条件进⾏查询，不计算分数，会对经常被过滤的数据进⾏缓存</p></blockquote> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index3/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;bool&quot;</span><span class="token punctuation">:</span><span class="token attr-value">{</span>
<span class="token attr-name">      &quot;filter&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">[</span>
        {
<span class="token attr-name">          &quot;match&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">            &quot;bookName&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;Java&quot;</span>
          }
        },
        {
<span class="token attr-name">          &quot;match&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">            &quot;author&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;张三&quot;</span>
          }
        }
      ]
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="_8-7、高亮显示-重点"><a href="#_8-7、高亮显示-重点" class="header-anchor">#</a> 8.7、高亮显示（重点）</h4> <blockquote><p>对匹配的关键词进⾏特殊样式的标记</p></blockquote> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">GET</span> <span class="token attr-value">/index3/_search</span>
{
<span class="token attr-name">  &quot;query&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;match&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">      &quot;bookName&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;Java&quot;</span>
    }
  },
<span class="token attr-name">  &quot;highlight&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">    &quot;fields&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{</span>
<span class="token attr-name">      &quot;bookName&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">{}</span>
    },
<span class="token attr-name">    &quot;pre_tags&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;&lt;label style='color:red'&gt;&quot;,</span>
<span class="token attr-name">    &quot;post_tags&quot;</span><span class="token punctuation">:</span> <span class="token attr-value">&quot;&lt;/label&gt;&quot;</span>
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_9、springboot整合es"><a href="#_9、springboot整合es" class="header-anchor">#</a> 9、SpringBoot整合ES</h2> <p>官⽅参考地址 https://www.elastic.co/guide/en/elasticsearch/client/index.html</p> <ul><li>RestLowerLevelClient</li> <li>RestHighLevelClient</li></ul> <h3 id="_9-1、创建springboot应用"><a href="#_9-1、创建springboot应用" class="header-anchor">#</a> 9.1、创建SpringBoot应用</h3> <p>略</p> <h3 id="_9-2、添加es的依赖"><a href="#_9-2、添加es的依赖" class="header-anchor">#</a> 9.2、添加es的依赖</h3> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_9-3、配置bean"><a href="#_9-3、配置bean" class="header-anchor">#</a> 9.3、配置Bean</h3> <p>创建ElasticSearchConfig，并编写内容</p> <blockquote><p>在springboot应⽤中已经提供了RestHighLevelClient实例，⽆需进⾏实例配置，但是需要进⾏es服务器地址配
置</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">RestHighLevelClient</span> getRe <span class="token function">stHighLevelClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">HttpHost</span> httpHost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;47.96.11.185&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">RestClientBuilder</span> restClientBuilder <span class="token operator">=</span> <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>httpHost<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">RestHighLevelClient</span> restHighLevelClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span>restClientBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> restHighLevelClient<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>在springboot应⽤配置连接：</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">spring</span><span class="token punctuation">:</span>
<span class="token attr-name">  elasticsearch</span><span class="token punctuation">:</span>
<span class="token attr-name">    rest</span><span class="token punctuation">:</span>
<span class="token attr-name">      uris</span><span class="token punctuation">:</span> <span class="token attr-value">http://47.96.11.185:9200</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_9-4、使用案例"><a href="#_9-4、使用案例" class="header-anchor">#</a> 9.4、使用案例</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">Esdemo3ApplicationTests</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Resource</span>
	<span class="token keyword">private</span> <span class="token class-name">RestHighLevelClient</span> restHighLevelClient<span class="token punctuation">;</span>
    <span class="token comment">/**
    * 在es中创建索引
    */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testCreateIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">CreateIndexRequest</span> createIndexRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CreateIndexRequest</span><span class="token punctuation">(</span><span class="token string">&quot;index4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CreateIndexResponse</span> createIndexResponse <span class="token operator">=</span>
        restHighLevelClient<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createIndexRequest<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>createIndexResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//System.out.println(createIndexResponse.isAcknowledged());</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
    * 删除索引
    */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testDeleteIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">DeleteIndexRequest</span> deleteIndexRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeleteIndexRequest</span><span class="token punctuation">(</span><span class="token string">&quot;index4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">AcknowledgedResponse</span> deleteIndexRes <span class="token operator">=</span>
        restHighLevelClient<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>deleteIndexRequest<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>deleteIndexRes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
    * 添加⽂档：将数据存⼊es
    */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testCreateDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Book</span> book <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token number">10005</span><span class="token punctuation">,</span><span class="token string">&quot;平凡的世界&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;路遥&quot;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ObjectMapper</span> objectMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> jsonStr <span class="token operator">=</span> objectMapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IndexRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span><span class="token string">&quot;index3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;10005&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">,</span> <span class="token class-name">XContentType</span><span class="token punctuation">.</span>JSON<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IndexResponse</span> indexResponse <span class="token operator">=</span> restHighLevelClient<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>indexResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
    * 搜索
    */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSearch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">SearchRequest</span> searchRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token string">&quot;index3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SearchSourceBuilder</span> searchSourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//分页查询</span>
        searchSourceBuilder<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        searchSourceBuilder<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//查询条件</span>
        <span class="token comment">// searchSourceBuilder.query(QueryBuilders.matchAllQuery());</span>
        searchSourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;bookName&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        searchSourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">multiMatchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;奥利奥&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;productName&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;productDesc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        
        <span class="token comment">//高亮显示</span>
        <span class="token class-name">HighlightBuilder</span> highlightBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HighlightBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HighlightBuilder<span class="token punctuation">.</span>Field</span> highlightTitle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HighlightBuilder<span class="token punctuation">.</span>Field</span><span class="token punctuation">(</span><span class="token string">&quot;bookName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        highlightTitle<span class="token punctuation">.</span><span class="token function">highlighterType</span><span class="token punctuation">(</span><span class="token string">&quot;unified&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        highlightBuilder<span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span>highlightTitle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        highlightBuilder<span class="token punctuation">.</span><span class="token function">preTags</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;label style='color:red'&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        highlightBuilder<span class="token punctuation">.</span><span class="token function">postTags</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/label&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        searchSourceBuilder<span class="token punctuation">.</span><span class="token function">highlighter</span><span class="token punctuation">(</span>highlightBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        searchRequest<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>searchSourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SearchResponse</span> searchResp <span class="token operator">=</span> restHighLevelClient<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>searchRequest<span class="token punctuation">,</span><span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> searchResp<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token operator">/</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span><span class="token punctuation">{</span>
        	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br></div></div><h5 id="批量添加-参考代码"><a href="#批量添加-参考代码" class="header-anchor">#</a> 批量添加（参考代码）</h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
* 批量插⼊ES
* @param indexName 索引
* @param type 类型
* @param idName id名称
* @param list 数据集合
*/</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">bulkData</span><span class="token punctuation">(</span><span class="token class-name">String</span> indexName<span class="token punctuation">,</span><span class="token class-name">String</span> type <span class="token punctuation">,</span><span class="token class-name">String</span> idName <span class="token punctuation">,</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> list
<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> list <span class="token operator">||</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    		<span class="token keyword">return</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>indexName<span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>idName<span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
        	<span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">BulkRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BulkRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">:</span> list<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>idName<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            	request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span>indexName<span class="token punctuation">,</span> type<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>idName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span><span class="token class-name">XContentType</span><span class="token punctuation">.</span>JSON<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 2、可选的设置</span>
        <span class="token comment">/*
        request.timeout(&quot;2m&quot;);
        request.setRefreshPolicy(&quot;wait_for&quot;);
        request.waitForActiveShards(2);
        */</span>
        <span class="token comment">//3、发送请求:同步请求</span>
        <span class="token class-name">BulkResponse</span> bulkResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">bulk</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//4、处理响应</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>bulkResponse <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">BulkItemResponse</span> bulkItemResponse <span class="token operator">:</span> bulkResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">DocWriteResponse</span> itemResponse <span class="token operator">=</span> bulkItemResponse<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>bulkItemResponse<span class="token punctuation">.</span><span class="token function">getOpType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">DocWriteRequest<span class="token punctuation">.</span>OpType</span><span class="token punctuation">.</span>INDEX
                <span class="token operator">||</span> bulkItemResponse<span class="token punctuation">.</span><span class="token function">getOpType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">DocWriteRequest<span class="token punctuation">.</span>OpType</span><span class="token punctuation">.</span>CREATE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">IndexResponse</span> indexResponse <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">IndexResponse</span><span class="token punctuation">)</span> itemResponse<span class="token punctuation">;</span>
                    <span class="token comment">//TODO 新增成功的处理</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;新增成功,{}&quot;</span><span class="token operator">+</span> indexResponse<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>bulkItemResponse<span class="token punctuation">.</span><span class="token function">getOpType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">DocWriteRequest<span class="token punctuation">.</span>OpType</span><span class="token punctuation">.</span>UPDATE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">UpdateResponse</span> updateResponse <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UpdateResponse</span><span class="token punctuation">)</span> itemResponse<span class="token punctuation">;</span>
                    <span class="token comment">//TODO 修改成功的处理</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;修改成功,{}&quot;</span><span class="token operator">+</span> updateResponse<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>bulkItemResponse<span class="token punctuation">.</span><span class="token function">getOpType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">DocWriteRequest<span class="token punctuation">.</span>OpType</span><span class="token punctuation">.</span>DELETE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">DeleteResponse</span> deleteResponse <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">DeleteResponse</span><span class="token punctuation">)</span> itemResponse<span class="token punctuation">;</span>
                    <span class="token comment">//TODO 删除成功的处理</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;删除成功,{}&quot;</span><span class="token operator">+</span> deleteResponse<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h5 id="查询数据封装"><a href="#查询数据封装" class="header-anchor">#</a> 查询数据封装</h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SearchHit</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> hits<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> products <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">SearchHit</span> searchHit <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> str <span class="token operator">=</span> searchHit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Product</span> product <span class="token operator">=</span> objectMapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token class-name">Product</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HighlightField</span> highlightField <span class="token operator">=</span> searchHit<span class="token punctuation">.</span><span class="token function">getHighlightFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;productName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>highlightField <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>highlightField<span class="token punctuation">.</span><span class="token function">fragments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setProductName</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    products<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/ZHANGChang47/BlogVuePress/edit/main/docs/07.组件/05.ElasticSearch.md" target="_blank" rel="noopener noreferrer">帮助我改善此页面</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023年2月4日</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/e9816e/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">RabbitMQ</div></a> <a href="/pages/cbaa60/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Gateway</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/e9816e/" class="prev">RabbitMQ</a></span> <span class="next"><a href="/pages/cbaa60/">Gateway</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/9b7514/"><div>
            沧桑百年史，爱国西交情
            <!----></div></a> <span class="date">02-04</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/d7b60a/"><div>
            承党恩泽，物阜民丰
            <!----></div></a> <span class="date">02-04</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/a0057c/"><div>
            静谧之眼
            <!----></div></a> <span class="date">02-04</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:2648492063@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/ZHANGChang47" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://typora001-zc.oss-cn-chengdu.aliyuncs.com/typoraImg/Snipaste_2023-02-03_22-33-33.webp" title="微信" target="_blank" class="iconfont icon-weixin"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2023
    <span>张畅 |<a href="https://beian.miit.gov.cn" target="_blank">陕ICP备2022001001号</a><br>	<img src="http://www.beian.gov.cn/img/new/gongan.png" border="0" /></a>	 		<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41018302000331" style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img src="" style="float:left;"/><p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px;">冀公网安备 13112802000237号</p></a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><APlayer audio="" fixed="true" mini="true" theme="#b7daff" loop="loop" order="list" preload="auto" volume="0.7" mutex="true" lrc-type="0" list-max-height="250" storage-name="vuepress-plugin-meting" id="aplayer-fixed"></APlayer><div></div><div></div><div></div><div id="tcomment"></div><!----></div></div>
    <script src="/assets/js/app.bb5e25c9.js" defer></script><script src="/assets/js/2.108e92a1.js" defer></script><script src="/assets/js/79.d4ff4d30.js" defer></script><script src="/assets/js/5.73b07204.js" defer></script><script src="/assets/js/13.9b1b1c77.js" defer></script><script src="/assets/js/14.e2f4930c.js" defer></script><script src="/assets/js/9.5b9b4ae3.js" defer></script><script src="/assets/js/10.68c0c324.js" defer></script>
  </body>
</html>
